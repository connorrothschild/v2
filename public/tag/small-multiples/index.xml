<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>small multiples | Connor Rothschild</title>
    <link>https://connorrothschild.com/tag/small-multiples/</link>
      <atom:link href="https://connorrothschild.com/tag/small-multiples/index.xml" rel="self" type="application/rss+xml" />
    <description>small multiples</description>
    <generator>Source Themes Academic (https://sourcethemes.com/academic/)</generator><language>en-us</language><copyright>Â© Connor Rothschild, 2020</copyright><lastBuildDate>Sat, 01 Feb 2020 00:00:00 +0000</lastBuildDate>
    <image>
      <url>https://connorrothschild.com/img/social.png</url>
      <title>small multiples</title>
      <link>https://connorrothschild.com/tag/small-multiples/</link>
    </image>
    
    <item>
      <title>Trends in Refugee Acceptance, 2002 to 2019</title>
      <link>https://connorrothschild.com/post/refugee-trends/</link>
      <pubDate>Sat, 01 Feb 2020 00:00:00 +0000</pubDate>
      <guid>https://connorrothschild.com/post/refugee-trends/</guid>
      <description>&lt;p&gt;&lt;img src=&#34;figures/final.svg&#34; alt=&#34;final&#34;&gt;&lt;/p&gt;
&lt;p&gt;In 
&lt;a href=&#34;https://connorrothschild.github.io/map-missing-migrants/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;previous projects&lt;/a&gt;, I&amp;rsquo;ve explored how migration has unfolded across &lt;em&gt;places&lt;/em&gt;: where migrants travel, where they go missing, and where their journeys come to a fatal end.&lt;/p&gt;
&lt;p&gt;Next, I wanted to see how &lt;em&gt;host countries&lt;/em&gt; have approached the migrant and refugee crisis, with a particular focus on the United States. In my mind, an effective visualization of the U.S.&amp;lsquo;s response to an increasing number of refugees needs to present two things: how refugee acceptance has changed &lt;em&gt;over time&lt;/em&gt; and how refugee acceptance differs &lt;em&gt;across states.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;An effective way to present both of these trends is with a map of 
&lt;a href=&#34;https://en.wikipedia.org/wiki/Small_multiple&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;small multiple&lt;/a&gt; line charts. For aesthetic purposes, it would also be nice to arrange these multiples in a shape that vaguely resembles the United States. (This also makes it easier for readers to find their state of interest.)&lt;/p&gt;
&lt;p&gt;There are examples of these types of small multiple maps across the internet. The Washington Post&amp;rsquo;s 
&lt;a href=&#34;https://www.washingtonpost.com/graphics/politics/how-fair-is-the-electoral-college/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;overview of the electoral college&lt;/a&gt; was visualized in the following way:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;figures/wapo.png&#34; alt=&#34;Washington Post small multiples map of electoral college data&#34;&gt;&lt;/p&gt;
&lt;p&gt;You can also find an overview of &lt;em&gt;why&lt;/em&gt; they work, and some additional examples, on the 
&lt;a href=&#34;https://policyviz.com/2016/05/19/small-multiple-tile-grid-map/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;PolicyViz&lt;/a&gt; blog:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;figures/policyviz.jpg&#34; alt=&#34;Policy Viz&amp;rsquo;s small multiples of overall voting results over time&#34;&gt;&lt;/p&gt;
&lt;h2 id=&#34;making-it-in-r&#34;&gt;Making it in R&lt;/h2&gt;
&lt;p&gt;The process of creating a small multiple tile grid map is relatively easy in R (like most things done in R). It is considerably more difficult in D3.js; if you&amp;rsquo;re interested in that type of thing, you can take a look at 
&lt;a href=&#34;https://bl.ocks.org/jinniluo/a95b27b1f4ea65ae94ab6ca3fcfb5934#index.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;this code&lt;/a&gt; for inspiration.&lt;/p&gt;
&lt;h4 id=&#34;step-1-build-the-basic-line-chart&#34;&gt;Step 1: Build the basic line chart&lt;/h4&gt;
&lt;p&gt;The first step (after obnoxious data 
&lt;a href=&#34;https://raw.githubusercontent.com/connorrothschild/R/master/refugee-trends/merge.R&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;merging&lt;/a&gt; and cleaning) is getting a feel for the basic line chart. To do so, we can visualize the macro-level trends of refugee acceptance across &lt;em&gt;all states&lt;/em&gt; combined.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;data %&amp;gt;% 
  group_by(region_name_3) %&amp;gt;% 
  summarise(textbox37 = sum(textbox37)) %&amp;gt;% 
  ggplot(aes(x = region_name_3, y = textbox37)) +
  geom_line() +
  labs(title = &amp;quot;Refugee Acceptance on the Decline&amp;quot;,
       subtitle = &amp;quot;Number of refugees accepted annually, 2002 - 2019&amp;quot;,
       x = element_blank(),
       y = element_blank()) +
  scale_y_continuous(labels = scales::comma_format()) +
  scale_x_continuous(breaks = c(2002, 2019))
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;figures/macro.jpg&#34; alt=&#34;Line chart of refugee acceptance per year; the line is gradually sloping downward&#34; style=&#34;zoom:50%;&#34; /&gt;&lt;/p&gt;
&lt;p&gt;Now we have the answer to our first question: &lt;strong&gt;how has refugee acceptance changed over time?&lt;/strong&gt; The answer: pretty drastically. The US accepted nearly 100,000 refugees in 2016; 2 years later, that number was barely over 20,000.&lt;/p&gt;
&lt;h4 id=&#34;step-2-make-small-multiples&#34;&gt;Step 2: Make small multiples&lt;/h4&gt;
&lt;p&gt;Next, we make 50 of these lines: one for each US state. We do so using Ryan Hafen&amp;rsquo;s &lt;code&gt;geofacet&lt;/code&gt; 
&lt;a href=&#34;https://hafen.github.io/geofacet/rd.html&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;package&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s as simple as adding one line of code to our previous plot:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;facet_geo(~ state)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;This makes a plot that looks like this:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;figures/firsttry.jpg&#34; alt=&#34;first try&#34;&gt;&lt;/p&gt;
&lt;p&gt;It&amp;rsquo;s alright, but not perfect! There are a few improvements we can definitely make.&lt;/p&gt;
&lt;p&gt;For one, the axis labels overlap. We already know the range of years is between 2002 and 2019 (its in our subtitle!). So we can remove our x axis labels.&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;theme(
  axis.text.x = element_blank(),
  axis.ticks.x = element_blank()
  )
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Second, The axis lines (on both axes) seem unnecessary and (the x-axis specifically) can sometimes conceal trends for those states with lower values. Let&amp;rsquo;s remove those too!&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;theme(
  axis.line.x = element_blank(),
  axis.line.y = element_blank()
  )
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Finally, I don&amp;rsquo;t like huge gray boxes around my axis labels. Could we make those transparent?&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;theme(
    strip.background = element_rect(color = &amp;quot;white&amp;quot;)
)
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Add it all together (and tweak the font size), and we get this:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;data %&amp;gt;% 
  group_by(region_name_3, state) %&amp;gt;% 
  summarise(textbox37 = sum(textbox37)) %&amp;gt;% 
  ggplot(aes(x = region_name_3, y = textbox37)) +
  geom_line(color = &amp;quot;black&amp;quot;) +
  scale_x_continuous(breaks = c(2002,2019)) +
  scale_y_continuous(breaks = c(0,12000)) +
  facet_geo(~ state, grid = &amp;quot;us_state_grid1&amp;quot;) +
  labs(title = &amp;quot;Refugee Acceptance on the Decline&amp;quot;,
       subtitle = &amp;quot;Number of refugees accepted annually, 2002 - 2019&amp;quot;,
       x = element_blank(),
       y = element_blank()) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank(),
    axis.line.x = element_blank(),
    axis.line.y = element_blank(),
    plot.title = element_text(size = 24),
    plot.subtitle = element_text(size = 18),
    strip.background = element_rect(color = &amp;quot;white&amp;quot;)
  )
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;figures/secondtry.jpg&#34; alt=&#34;secondtry&#34;&gt;&lt;/p&gt;
&lt;p&gt;Pretty good! Much better. But we can add some elements to take our visualization to the next level.&lt;/p&gt;
&lt;p&gt;Because our data spans nearly 20 years (2002 to 2019), we can overlay our small multiples with other variables of interest, such as who was President during a given period.&lt;/p&gt;
&lt;p&gt;We do so using &lt;code&gt;geom_rect&lt;/code&gt;:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;geom_rect(mapping=aes(xmin=2009, xmax=2017, ymin=0, ymax=12000), fill = &amp;quot;#ADD8E6&amp;quot;, alpha = .05) +
geom_rect(mapping=aes(xmin=2017, xmax=2019, ymin=0, ymax=12000), fill = &amp;quot;#FF9999&amp;quot;, alpha = .05) +
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;The first line of code creates a blue box which spans 2009 to 2017 (Obama&amp;rsquo;s tenure). The second line creates a red box for Trump&amp;rsquo;s presidency (so far).&lt;/p&gt;
&lt;p&gt;Bringing it all together, the code and output look like this:&lt;/p&gt;
&lt;pre&gt;&lt;code class=&#34;language-R&#34;&gt;data %&amp;gt;% 
  group_by(region_name_3, state) %&amp;gt;% 
  summarise(textbox37 = sum(textbox37)) %&amp;gt;% 
  ggplot(aes(x = region_name_3, y = textbox37)) +
  geom_line(color = &amp;quot;black&amp;quot;) +
  geom_rect(mapping=aes(xmin=2009, xmax=2017, ymin=0, ymax=12000), fill = &amp;quot;#ADD8E6&amp;quot;, alpha = .05) +
  geom_rect(mapping=aes(xmin=2017, xmax=2019, ymin=0, ymax=12000), fill = &amp;quot;#FF9999&amp;quot;, alpha = .05) +
  scale_x_continuous(breaks = c(2002,2019)) +
  scale_y_continuous(breaks = c(0,12000)) +
  facet_geo(~ state, grid = &amp;quot;us_state_grid1&amp;quot;) +
  labs(title = &amp;quot;Refugee Acceptance on the Decline&amp;quot;,
       subtitle = &amp;quot;Number of refugees accepted annually, 2002 - 2019&amp;quot;,
       x = element_blank(),
       y = element_blank()) +
  theme(
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank(),
    axis.line.x = element_blank(),
    axis.line.y = element_blank(),
    plot.title = element_text(size = 24),
    plot.subtitle = element_text(size = 18),
    strip.background = element_rect(color = &amp;quot;white&amp;quot;)
  )
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;figures/ref.png&#34; alt=&#34;r version&#34;&gt;&lt;/p&gt;
&lt;p&gt;I brought that plot to Illustrator and made it a lot prettier. Here&amp;rsquo;s the final version:&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;figures/final.svg&#34; alt=&#34;final version&#34;&gt;&lt;/p&gt;
&lt;p&gt;What do we notice? A few key states (Texas, California, Florida, and Michigan) make up the vast majority of refugee acceptance, while other accept almost &lt;em&gt;no&lt;/em&gt; &lt;em&gt;refugees&lt;/em&gt;. Nearly every state has reduced their refugee acceptance since 2017, but the bulk of this decline has come from these larger states.&lt;/p&gt;
&lt;p&gt;While you&amp;rsquo;re here, take a look at my project 
&lt;a href=&#34;https://connorrothschild.github.io/map-missing-migrants/&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;&lt;em&gt;Mapping Missing Migrants.&lt;/em&gt;&lt;/a&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>
