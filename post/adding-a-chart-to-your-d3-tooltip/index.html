<!DOCTYPE html><html lang="en-us" >

<head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="generator" content="Source Themes Academic 4.8.0">
  
    
  
    
    
    
    
    
      
      
      
    
    
  
    <meta name="author" content="Connor Rothschild">
  
    
    
    
      
    
    <meta name="description" content="A few lines of code can make your D3 tooltips signficantly more informative.">
  
    
    <link rel="alternate" hreflang="en-us" href="https://connorrothschild.github.io/v2/post/adding-a-chart-to-your-d3-tooltip/">
  
    


    
    
    
    <meta name="theme-color" content="black">
    
  
    
    
  
    
    
    
    
      
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css" integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin="anonymous">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css" integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin="anonymous">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css" integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin="anonymous">
  
      
      
      
        
      
      
        
        
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github-gist.min.css" crossorigin="anonymous" title="hl-light">
          <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github-gist.min.css" crossorigin="anonymous" title="hl-dark" disabled>
        
      
  
      
  
      
  
      
      
        
  
        
        
  
        
      
        
  
        
        
  
        
      
        
  
        
        
  
        
      
        
  
        
        
  
        
      
        
  
        
        
  
        
      
        
  
        
        
  
        
      
        
  
        
        
  
        
      
        
  
        
        
  
        
      
        
  
        
        
  
        
      
        
  
        
        
  
        
      
        
  
        
        
  
        
          <script src="https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js" integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin="anonymous" async></script>
        
      
        
  
        
        
  
        
      
        
  
        
        
  
        
      
        
  
        
        
          
        
  
        
      
        
  
        
        
  
        
      
  
    
  
    
    
    
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Muli:400,500,600,700,800,900%7CLato:400,500,600,700,800,900%7CRoboto+Mono:400,500,600,700,800,900%7CKhula:400,500,600,700%7CInter:400,500,600,700,800,900&display=swap">
    
  
    
    
    
    
    <link rel="stylesheet" href="/v2/css/academic.css">
  
    




    

  
    
    

    
  <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"></script>
  <link rel="stylesheet" href="/v2/css/codefolding.css" />

  
    
  
    <link rel="manifest" href="/v2/index.webmanifest">
    <link rel="icon" type="image/png" href="/v2/images/icon_hu82528eb29b5d31779afb6f1becdf1c8e_5759_32x32_fill_lanczos_center_2.png">
    <link rel="apple-touch-icon" type="image/png" href="/v2/images/icon_hu82528eb29b5d31779afb6f1becdf1c8e_5759_192x192_fill_lanczos_center_2.png">
  
    <link rel="canonical" href="https://connorrothschild.github.io/v2/post/adding-a-chart-to-your-d3-tooltip/">
  
    
    
    
    
    
    
    
      
    
    
    <meta property="twitter:card" content="summary_large_image">
    
    <meta property="twitter:site" content="@CL_Rothschild">
    <meta property="twitter:creator" content="@CL_Rothschild">
    
    <meta property="og:site_name" content="Connor Rothschild">
    <meta property="og:url" content="https://connorrothschild.github.io/v2/post/adding-a-chart-to-your-d3-tooltip/">
    <meta property="og:title" content="How (and Why) to Add a Chart to Your D3.js Tooltip | Connor Rothschild">
    <meta property="og:description" content="A few lines of code can make your D3 tooltips signficantly more informative."><meta property="og:image" content="https://connorrothschild.github.io/v2/post/adding-a-chart-to-your-d3-tooltip/featured.jpg">
    <meta property="twitter:image" content="https://connorrothschild.github.io/v2/post/adding-a-chart-to-your-d3-tooltip/featured.jpg"><meta property="og:locale" content="en-us">
    
      
        <meta property="article:published_time" content="2020-01-04T00:00:00&#43;00:00">
      
      <meta property="article:modified_time" content="2020-06-01T11:13:28-05:00">
    
  
    


    






  




<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://connorrothschild.github.io/v2/post/adding-a-chart-to-your-d3-tooltip/"
  },
  "headline": "How (and Why) to Add a Chart to Your D3.js Tooltip",
  
  "image": [
    "https://connorrothschild.github.io/v2/post/adding-a-chart-to-your-d3-tooltip/featured.jpg"
  ],
  
  "datePublished": "2020-01-04T00:00:00Z",
  "dateModified": "2020-06-01T11:13:28-05:00",
  
  "author": {
    "@type": "Person",
    "name": "Connor Rothschild"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Connor Rothschild",
    "logo": {
      "@type": "ImageObject",
      "url": "https://connorrothschild.github.io/v2/images/icon_hu82528eb29b5d31779afb6f1becdf1c8e_5759_192x192_fill_lanczos_center_2.png"
    }
  },
  "description": "A few lines of code can make your D3 tooltips signficantly more informative."
}
</script>

  

  

  
    

  
    




  
    
  
    <title>How (and Why) to Add a Chart to Your D3.js Tooltip | Connor Rothschild</title>
  
  </head>
  
<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" >

  <aside class="search-results" id="search">
  <div class="container">
    <section class="search-header">

      <div class="row no-gutters justify-content-between mb-3">
        <div class="col-6">
          <h1>Search</h1>
        </div>
        <div class="col-6 col-search-close">
          <a class="js-search" href="#"><i class="fas fa-times-circle text-muted" aria-hidden="true"></i></a>
        </div>
      </div>

      <div id="search-box">
        
        <input name="q" id="search-query" placeholder="Search..." autocapitalize="off"
        autocomplete="off" autocorrect="off" spellcheck="false" type="search">
        
      </div>

    </section>
    <section class="section-search-results">

      <div id="search-hits">
        
      </div>

    </section>
  </div>
</aside>


  







<nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
  <div class="container">

    
    <div class="d-none d-lg-inline-flex">
      <a class="navbar-brand" href="/v2/">Connor Rothschild</a>
    </div>
    

    
    <button type="button" class="navbar-toggler" data-toggle="collapse"
            data-target="#navbar-content" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
    <span><i class="fas fa-bars"></i></span>
    </button>
    

    
    <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
      <a class="navbar-brand" href="/v2/">Connor Rothschild</a>
    </div>
    

    
    
    <div class="navbar-collapse main-menu-item collapse justify-content-start" id="navbar-content">

      
      <ul class="navbar-nav d-md-inline-flex">
        

        

        
        
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link  active" href="/v2/post"><span>Blog</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/v2/#experience"><span>Experience</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/v2/#accomplishments"><span>Awards</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/v2/#projects"><span>Projects</span></a>
        </li>

        
        

        

        
        
        
          
        

        
        
        
        
        
        
          
          
          
            
          
          
        

        <li class="nav-item">
          <a class="nav-link " href="/v2/#contact"><span>Contact</span></a>
        </li>

        
        

        

        
        
        
          
            
          
        

        
        
        
        
        
        

        <li class="nav-item">
          <a class="nav-link " href="https://docs.google.com/document/d/1qBH-wNMe2nv9Xa4uzHZ5wBevohwKuB3h2i9M2yk4POk/edit?usp=sharing" target="_blank" rel="noopener"><span>Resume</span></a>
        </li>

        
        

      

        
      </ul>
    </div>

    <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">
      
      <li class="nav-item">
        <a class="nav-link js-search" href="#"><i class="fas fa-search" aria-hidden="true"></i></a>
      </li>
      

      

      

    </ul>

  </div>
</nav>


  
          <article class="article">
            












  

  
  
  
<div class="article-container pt-3">
  <h1>How (and Why) to Add a Chart to Your D3.js Tooltip</h1>

  

  
    


<div class="article-metadata">

  
  
  
  
  <div>
    

  
  <span>Connor Rothschild</span>
  </div>
  
  

  
  <span class="article-date">
    
    
      
          Last updated on
      
    
    Jun 1, 2020
  </span>
  

  

  
  <span class="middot-divider"></span>
  <span class="article-reading-time">
    12 min read
  </span>
  

  
  
  

  
  
  <span class="middot-divider"></span>
  <span class="article-categories">
    <i class="fas fa-folder mr-1"></i><a href="/v2/category/d3.js/">D3.js</a></span>
  

</div>

    














    

<div id="code-folding-buttons" class="dropdown btn-group pull-right">
  <a class="btn btn-light btn-sm dropdown-toggle" href="#" role="button" id="allCodeToggleButton"
     data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
    Code
  </a>
  <div class="dropdown-menu" aria-labelledby="allCodeToggleButton">
    <a id="rmd-show-all-code" class="dropdown-item small" href="#">Show all</a>
    <a id="rmd-hide-all-code" class="dropdown-item small" href="#">Hide all</a>
  </div>
</div>



  
</div>


          <div class="article-container">
            <div class="article-style">
              <p>I think tooltips are one of the most underrated parts of a visualization. When users are initially confused by a visualization, they often hover over a data point of interest to get more information.</p>
<p>Unfortunately, many tooltips fail to really illuminate much about our data. They often recapitulate what is already being presented without clarifying any of the confusing parts of the data. Most frequently, I see (and even create 😦) tooltips which present the most basic information (in a map, a tooltip would present the state name and the value of interest), and nothing else!</p>
<p>Of course, there&rsquo;s nothing <em>wrong</em> with these kinds of tooltips. But they are truly doing the bare minimum, and, as a result, they&rsquo;re missing out on the full potential of tooltips. <strong>If users are actively seeking more information by hovering over data, we ought to reward them with the most helpful and interesting information we can.</strong></p>
<p>That&rsquo;s why I recently updated one of my tooltips from a static presentation of textual information to a line chart depicting change over time. In other words, I went from this:</p>
<p><img src="figures/old-tooltip.gif" alt=""></p>
<p>to this:</p>
<p><img src="figures/new-tooltip.gif" alt=""></p>
<h2 id="why-did-i-make-that-change">Why did I make that change?</h2>
<p>The former tooltip provided information which was rather uninteresting. Although it clarified the exact <em>rate</em> of overdose deaths in a given state at a given time, it didn&rsquo;t do much else. It did provide the year currently in view, but this was also visible in the bottom right corner of the visualization! It also provided the state name, but most of my viewers have likely taken US geography in middle school.</p>
<p>Thus, this tooltip was rather redundant. At best, it provided the <em>exact</em> rate, so that a viewer could compare two states, or learn more information about a given state without solely relying on color encoding (
<a href="https://courses.cs.washington.edu/courses/cse442/17au/lectures/CSE442-VisualEncoding.pdf" target="_blank" rel="noopener">which can be somewhat unreliable when it comes to quantitative encoding</a>, as is the case in a choropleth map).</p>
<p>The new tooltip shows a trend over time. It also shows the state name (just in case you skipped that day in US geography!), and also the most recent data on overdose deaths. Because this map is meant to show how the opioid crisis <em>has evolved</em>, showing a line chart for each state in my tooltip allows the user to explore state-by-state trends on hover! This is much easier than hovering on each state during each year and trying to keep track of the trends.</p>
<p>For example, hovering on West Virginia, which in 2017 seemed to have the highest opioid-involved overdose death rate (as indicated by it having the darkest shade of red), reveals that its also experienced one of the largest over-time increase in this rate since 1999:</p>
<p><img src="figures/west-virginia.jpg" alt="West Virginia Image"></p>
<h2 id="so-how-do-you-do-it">So, how do you do it?</h2>
<p>Great question! It&rsquo;s thankfully not that hard, but the payoff is huge. The shift from my old, boring tooltip to my new, sexy one took only a couple of hours, thanks to a few 
<a href="https://stackoverflow.com/questions/43904643/add-chart-to-tooltip-in-d3" target="_blank" rel="noopener">Stack Overflow answers</a> and 
<a href="https://bl.ocks.org/maelafifi/ee7fecf90bb5060d5f9a7551271f4397" target="_blank" rel="noopener">online examples</a>.</p>
<h3 id="step-1-load-d3-tip">Step 1: Load <code>d3-tip</code></h3>
<p>The process mostly relies on <code>d3-tip</code>, which you can learn more about 
<a href="http://labratrevenge.com/d3-tip/" target="_blank" rel="noopener">here</a>.</p>
<p>You can load <code>d3-tip</code>with the following code:</p>
<pre><code class="language-javascript">&lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.7.1/d3-tip.min.js&quot;&gt;&lt;/script&gt;
</code></pre>
<h3 id="step-2-create-a-tooltip-object">Step 2: Create a tooltip object</h3>
<p>Next, you initialize your tooltip, give it a class (for CSS styling), and provide the specified <code>offset</code>. In my example, I define my offset according to the 
<a href="https://stackoverflow.com/questions/28536367/in-d3-js-how-to-adjust-tooltip-up-and-down-based-on-the-screen-position" target="_blank" rel="noopener">user&rsquo;s mouse position</a>. That way, if a user hovers over an eastern state, the tooltip doesn&rsquo;t disappear off the screen!</p>
<pre><code class="language-javascript">  // define the tooltip 
var tool_tip = d3.tip()
  .attr(&quot;class&quot;, &quot;d3-tip&quot;)
  // if the mouse position is greater than 650 (~ Kentucky/Missouri), offset tooltip to the left instead of the right
  .offset(function() {if(current_position[0] &gt; 650) {
  	return [-20,-120] } 
  	else { return [20,120]}
  })
  // input the title, and include the div
  .html(
  	&quot;&lt;p&gt;Opioid-involved deaths over time in&lt;/p&gt;&lt;div id='tipDiv'&gt;&lt;/div&gt;&quot;
  );

svg.call(tool_tip);
</code></pre>
<p>The most important part here is</p>
<pre><code class="language-javascript">.html(
     &quot;&lt;p&gt;Opioid-involved deaths over time in&lt;/p&gt;&lt;div id='tipDiv'&gt;&lt;/div&gt;&quot;
);
</code></pre>
<p>where we define the html that creates the tooltip itself. In our case, we provide a title, &ldquo;Opioid-involved deaths over time&rdquo;, and also specify the div that the tooltip should include.</p>
<h3 id="step-3-create-the-tipdiv-object">Step 3: Create the <code>tipDiv</code> object</h3>
<p>Finally, we can create the <code>tipDiv</code> object we referenced in the above code. The object will be created on mouseover of the group of interest (in my case, states). Thus, the code will look something like this:</p>
<pre><code class="language-javascript">states = svg.append(&quot;g&quot;)
  .attr(&quot;class&quot;, &quot;states&quot;)
  .selectAll(&quot;path&quot;)
  .data(topojson.feature(us, us.objects.states).features)
  .enter()
  .append(&quot;path&quot;)
  .attr(&quot;d&quot;, path)
  .on('mouseover', function(d) {

// define and store the mouse position. this is used to define tooltip offset, seen above.
current_position = d3.mouse(this); 				

// define current state
current_state = nameById[d.id]
	
// show the tooltip
tool_tip.show();
</code></pre>
<p>After that initialization and <code>show</code> function, we can define the <code>tipDiv</code> object:</p>
<pre><code class="language-javascript">var tipSVG = d3.select(&quot;#tipDiv&quot;)
     .append(&quot;svg&quot;)
     .attr(&quot;width&quot;, 220)
     .attr(&quot;height&quot;, 55);

tipSVG.append(&quot;path&quot;)
     .datum(overdoses.filter(function(d) {return nameById[d.id] == current_state}))
     .style(&quot;stroke&quot;, function() {
     	if (rateById[d.id] &lt; 10) {
     		return &quot;grey&quot;
     	} else {
     	return color(rateById[d.id])
     	}
 	  })
     .style(&quot;stroke-width&quot;, 1.5)
     .style(&quot;fill&quot;, &quot;none&quot;)
     .attr(&quot;d&quot;, line)
     
tipSVG.append(&quot;circle&quot;)
     .attr(&quot;fill&quot;, function() {
     	if (rateById[d.id] &lt; 10) {
     		return &quot;grey&quot;
     	} else {
     	return color(rateById[d.id])
     	}
 	  })
    .attr(&quot;stroke&quot;, &quot;black&quot;)
    .attr(&quot;cx&quot;, 130)
    .attr(&quot;cy&quot;, y_tooltip(rateById[d.id]))
    .attr(&quot;r&quot;, 3)

tipSVG.append(&quot;text&quot;)
     .text(rateById[d.id] + &quot; deaths&quot;)
     .attr(&quot;x&quot;, 140)
     .attr(&quot;y&quot;, function() {
     	if (y_tooltip(rateById[d.id]) &lt; 15) { return 10 }
     		else { return y_tooltip(rateById[d.id]) - 7 }
     	})

tipSVG.append(&quot;text&quot;)
     .text(&quot;per 100,000&quot;)
     .attr(&quot;x&quot;, 140)
     .attr(&quot;y&quot;, function() {
     	if (y_tooltip(rateById[d.id]) &lt; 15) { return 24 }
     		else { return y_tooltip(rateById[d.id]) + 7 }
     	})
	
tipSVG.append(&quot;text&quot;)
     .text(current_state)
     .attr(&quot;x&quot;, 0)
     .attr(&quot;y&quot;, 15)
     .style(&quot;font-size&quot;, 18)
     .style(&quot;font-weight&quot;, 400)
 })
.on('mouseout', tool_tip.hide)
</code></pre>
<p>What&rsquo;s happening here? Let&rsquo;s look at one piece at a time.</p>
<p><strong>First</strong>, we define the object and name it <code>tipSVG</code>. <code>tipSVG</code> selects <code>#tipDiv</code> (defined in our d3-tip) and appends an SVG. We also define the width and height of the tooltip.</p>
<pre><code class="language-javascript">var tipSVG = d3.select(&quot;#tipDiv&quot;)
	      .append(&quot;svg&quot;)
	      .attr(&quot;width&quot;, 220)
	      .attr(&quot;height&quot;, 55);
</code></pre>
<p><strong>Next</strong>, we append a path to that SVG. This could be a circle, or a rectangle, or any other appendable shape. Because I am drawing a simple line, we use <code>path</code>.</p>
<pre><code class="language-javascript">tipSVG.append(&quot;path&quot;)
  .datum(overdoses.filter(function(d) {return nameById[d.id] == current_state}))
  .style(&quot;stroke&quot;, function() {
  	if (rateById[d.id] &lt; 10) {
  		return &quot;grey&quot;
  	} else {
  	return color(rateById[d.id])
  	}
	  })
  .style(&quot;stroke-width&quot;, 1.5)
  .style(&quot;fill&quot;, &quot;none&quot;)
  .attr(&quot;d&quot;, line)
</code></pre>
<p>In defining the <code>d</code> attribute, you see I use the phrase <code>line</code>. This is defined earlier in my code to return the x and y position of each data point, to create the path itself.</p>
<pre><code class="language-javascript">var x_tooltip = d3.scaleLinear()
  .domain(d3.extent(overdoses, function(d) { return d.year; }))
  .range([ 0, 130 ]);

var y_tooltip = d3.scaleLinear()
  .domain([0, 60])
  .range([ 50, 0 ]);

var line = d3.line()
  .x(function(d) {
    return x_tooltip(d.year);
  })
  .y(function(d) {
    return y_tooltip(+d.rate);
  })
</code></pre>
<p><strong>Lastly</strong>, we add a circle at the end of the line to signify the final data point. We also add the text label for the year 2017.</p>
<pre><code class="language-javascript">tipSVG.append(&quot;circle&quot;)
  .attr(&quot;fill&quot;, function() {
  	if (rateById[d.id] &lt; 10) {
  		return &quot;grey&quot;
  	} else {
  	return color(rateById[d.id])
  	}
	  })
   .attr(&quot;stroke&quot;, &quot;black&quot;)
  .attr(&quot;cx&quot;, 130)
  .attr(&quot;cy&quot;, y_tooltip(rateById[d.id]))
  .attr(&quot;r&quot;, 3)

tipSVG.append(&quot;text&quot;)
  .text(rateById[d.id] + &quot; deaths&quot;)
  .attr(&quot;x&quot;, 140)
  .attr(&quot;y&quot;, function() {
  	if (y_tooltip(rateById[d.id]) &lt; 15) { return 10 }
  		else { return y_tooltip(rateById[d.id]) - 7 }
  	})

tipSVG.append(&quot;text&quot;)
  .text(&quot;per 100,000&quot;)
  .attr(&quot;x&quot;, 140)
  .attr(&quot;y&quot;, function() {
  	if (y_tooltip(rateById[d.id]) &lt; 15) { return 24 }
  		else { return y_tooltip(rateById[d.id]) + 7 }
  	})

tipSVG.append(&quot;text&quot;)
  .text(current_state)
  .attr(&quot;x&quot;, 0)
  .attr(&quot;y&quot;, 15)
  .style(&quot;font-size&quot;, 18)
  .style(&quot;font-weight&quot;, 400)
 })
</code></pre>
<p>And finally, we hide the tooltip on mouseout:</p>
<pre><code class="language-javascript">.on('mouseout', tool_tip.hide)
</code></pre>
<p>Thanks for reading! You can play around with the visualization and checkout the tooltip for yourself here (find the fullscreen version 
<a href="https://connorrothschild.github.io/D3.js/map-overdoses/" target="_blank" rel="noopener">here</a>):</p>
<div>    
<svg width="960" height="600"></svg>
</div>
<style>

@import url('https://rsms.me/inter/inter.css');
html { font-family: 'Inter', sans-serif; }
@supports (font-variation-settings: normal) {
  html { font-family: 'Inter var', sans-serif; }
}

.states :hover {
  stroke: white;
  stroke-width: 8px;
}

.year.label {
  font: 300 2.5em "Inter";
  fill: gray;
}

.helper.label {
  font: 150 1em "Inter";
  fill: gray;
}

.overlay {
  fill: none;
  pointer-events: all;
  cursor: ew-resize;
}

.caption {
  font: 150 1.1em "Inter";
}

.d3-tip {
  padding-right: 6px;
  padding-left: 6px;
  padding-bottom: 6px;
  padding-top: 0;
  background: #fff;
  border: 1px solid black;
  font-size: 12px;
  pointer-events: none !important;
}

/* .my_chart {
	width: 90%;
	padding-left: 15%;
	padding-right: 10%;
} */

</style>
<script src="https://d3js.org/d3.v4.min.js"></script>
<script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
<script src="https://d3js.org/topojson.v1.min.js"></script>
<script src="https://d3js.org/queue.v1.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3-tip/0.7.1/d3-tip.min.js"></script>
<script>

/* This viz was made a lot easier thanks to the following code:

* animation using TweenYear
http://bl.ocks.org/jgujgu/bfbb41f5e8b90ff09d7805f71ef2538e
* choropleth map of us states (using json fips state ids)
https://bl.ocks.org/chucklam/f628765b873d707a3d0e44ffc78deab8
* another choropleth; although I didn't end up following its structure it was a helpful introduction
https://bl.ocks.org/wboykinm/dbbe50d1023f90d4e241712395c27fb3

A special thanks to Robert Hosbach for his viz here (and his willingness to respond to my email!): https://rahosbach.github.io/2018-10-27-d3UnemploymentChoropleth/
*/  

var svg = d3.select("svg")
  .attr("class", "my_chart")
  // resize plot when window is resized (see below)
  .call(responsivefy);

var path = d3.geoPath();
var format = d3.format("");
var height = 600;
var width = 960;

// thanks to https://brendansudol.com/writing/responsive-d3 for this function!
function responsivefy(svg) {
  // container will be the DOM element
  // that the svg is appended to
  // we then measure the container
  // and find its aspect ratio
  const container = d3.select(svg.node().parentNode),
      width = parseInt(svg.style('width'), 10),
      height = parseInt(svg.style('height'), 10),
      aspect = width / height;

  // set viewBox attribute to the initial size
  // control scaling with preserveAspectRatio
  // resize svg on inital page load
  svg.attr('viewBox', `0 0 ${width} ${height}`)
      .attr('preserveAspectRatio', 'xMinYMid')
      .call(resize);

  // add a listener so the chart will be resized
  // when the window resizes
  // multiple listeners for the same event type
  // requires a namespace, i.e., 'click.foo'
  // api docs: https://goo.gl/F3ZCFr
  d3.select(window).on(
      'resize.' + container.attr('id'), 
      resize
  );

  // this is the code that resizes the chart
  // it will be called on load
  // and in response to window resizes
  // gets the width of the container
  // and resizes the svg to fill it
  // while maintaining a consistent aspect ratio
  function resize() {
      const w = parseInt(container.style('width'));
      svg.attr('width', w);
      svg.attr('height', Math.round(w / aspect));
  }
}

// options for color scheme: https://github.com/d3/d3-scale-chromatic
var colorScheme = d3.schemeReds[9];
colorScheme.unshift("#eee");

// building the legend at the top
var color = d3.scaleQuantize()
  .domain([0, 50])
  .range(colorScheme);
var x = d3.scaleLinear()
  .domain(d3.extent(color.domain()))
  // the range specifies the x position of the legend
  .rangeRound([600,860]);
var g = svg.append("g")
  .attr("transform", "translate(0,40)");

// legend boxes
g.selectAll("rect")
  .data(color.range().map(function(d){ return color.invertExtent(d); }))
  .enter()
  .append("rect")
    .attr("height", 8)
    .attr("x", function(d){ return x(d[0]); })
    .attr("width", function(d){ return x(d[1]) - x(d[0]); })
    .attr("fill", function(d){ return color(d[0]); });

// legend title
g.append("text")
  .attr("class", "caption")
  .attr("x", x.range()[0])
  .attr("y", -6)
  .attr("fill", "#000")
  .attr("text-anchor", "start")
  .attr("font-weight", 30)
  .text("Overdose Death Rate (Per 100,000)");

// legend ticks
g.call(d3.axisBottom(x)
  .tickSize(13)
  .tickFormat(format)
  .tickValues(color.range().slice(1).map(function(d){ return color.invertExtent(d)[0]; })))
  .select(".domain")
  .remove();

// create tooltip
var div = d3.select("body")
  .append("div")
  .attr("class", "tooltip")
  .style("opacity", 0);

// label positions
labely = height - 50
labelx = width - 280

// Add the year label; the value is set on transition.
var label = svg.append("text")
  .attr("class", "year label")
  .attr("text-anchor", "middle")
  // position the label
  .attr("y", labely)
  .attr("x", labelx)
  .text(1999);

var helperlabel = svg.append("text")
  .attr("class", "helper label")
  .attr("text-anchor", "middle")
  // position the label
  .attr("y", labely + 20)
  .attr("x", labelx)
  .text("Hover to change year");

queue()
  // read in JSON which includes all of the complicated shape data for states/counties/etc.
  .defer(d3.json, "https://d3js.org/us-10m.v1.json")
  // read in opioid data
  .defer(d3.csv, "figures/overdoses.csv")
  /*
  NOTE ON OVERDOSE DATA: 

  This CSV file was created via pulling data from CDC's WONDER database.

  I pulled all deaths from the National Vital Statistics System's multiple cause-of-death mortality files which had one of the following causes of death: opioids (T40.0, T40.1, T40.2, T40.3, T40.4, or T40.6)**; natural/semisynthetic opioids (T40.2); methadone (T40.3); heroin (T40.1); synthetic opioids other than methadone (T40.4); cocaine (T40.5). I followed the methodology of this paper: https://www.cdc.gov/mmwr/volumes/67/wr/mm675152e1.htm?s_cid=mm675152e1_w. Deaths may include multiple opioids as a cause and thus are not mutually exclusive.

  You can replicate the data pull on CDC WONDER with this link: https://wonder.cdc.gov/mcd-icd10.html

  Source: Multiple Cause of Death 1999–2017 on CDC Wide-ranging Online Data for Epidemiologic Research (CDC WONDER). Atlanta, GA: CDC, National Center for Health Statistics. 2018. Available at http://wonder.cdc.gov. 
  */
  .await(ready);

function ready(error, us, overdoses) {
  if (error) throw error;

    // Initialize data to 1990
    var currentYear = 1999;
    var rateById = {};
    var nameById = {};
    // var yearById = {};
    
    //console.table(overdoses)
    
    overdoses.forEach(function(d){
   	  rateById[d.id] = +d.rate;
      nameById[d.id] = d.state;
      d.year = d.year;
  });

   	console.table(overdoses)

    // Add an overlay for the year label.
    var box = label.node().getBBox();
    
    var overlay = svg.append("rect")
      .attr("class", "overlay")
      .attr("x", box.x)
      .attr("y", box.y)
      .attr("width", box.width)
      .attr("height", box.height)
      .on("mouseover", enableInteraction);

  var x_tooltip = d3.scaleLinear()
    .domain(d3.extent(overdoses, function(d) { return d.year; }))
    .range([ 0, 130 ]);

  var y_tooltip = d3.scaleLinear()
    .domain([0, 60])
    .range([ 50, 0 ]);

  // define line function
  var line = d3.line()
    .x(function(d) {
      return x_tooltip(d.year);
    })
    .y(function(d) {
      return y_tooltip(+d.rate);
    })

  var tool_tip = d3.tip()
  .attr("class", "d3-tip")
  // if the mouse position is greater than 650 (~ Kentucky/Missouri), 
  // offset tooltip to the left instead of the right
  // credit https://stackoverflow.com/questions/28536367/in-d3-js-how-to-adjust-tooltip-up-and-down-based-on-the-screen-position
  .offset(function() {if(current_position[0] > 650) {
  	return [-20,-120] } 
  	else { return [20,120]}
  })
  .html(
  	"<p>Opioid-involved deaths over time in</p><div id='tipDiv'></div>"
  );

	svg.call(tool_tip);
	
	// Start a transition that interpolates the data based on year.
	svg.transition()
	  .duration(10000)
	  .ease(d3.easeLinear)
	  .tween("year", tweenYear);
	
	states = svg.append("g")
	  .attr("class", "states")
	  .selectAll("path")
	  .data(topojson.feature(us, us.objects.states).features)
	  .enter()
	  .append("path")
	  .attr("d", path)
	  // appending svg inside of tooltip for year by year change.
	  // h/t https://bl.ocks.org/maelafifi/ee7fecf90bb5060d5f9a7551271f4397
	  // h/t https://stackoverflow.com/questions/43904643/add-chart-to-tooltip-in-d3
	   .on('mouseover', function(d) {
	
	   	// define and store the mouse position. this is used to define
	   	// tooltip offset, seen above.
		current_position = d3.mouse(this); 				
	   	//console.log(current_position[0])
	
	   	current_state = nameById[d.id]
	
	    tool_tip.show();
	    var tipSVG = d3.select("#tipDiv")
	      .append("svg")
	      .attr("width", 220)
	      .attr("height", 55);
	
	    tipSVG.append("path")
	      .datum(overdoses.filter(function(d) {return nameById[d.id] == current_state}))
	      .style("stroke", function() {
	      	if (rateById[d.id] < 10) {
	      		return "grey"
	      	} else {
	      	return color(rateById[d.id])
	      	}
	  	  })
	      .style("stroke-width", 1.5)
	      .style("fill", "none")
	      .attr("d", line)
	      
	    tipSVG.append("circle")
	      .attr("fill", function() {
	      	if (rateById[d.id] < 10) {
	      		return "grey"
	      	} else {
	      	return color(rateById[d.id])
	      	}
	  	  })
	      .attr("stroke", "black")
	      .attr("cx", 130)
		  .attr("cy", y_tooltip(rateById[d.id]))
		  .attr("r", 3)
	
	    tipSVG.append("text")
	      .text(rateById[d.id] + " deaths")
	      // .transition()
	      // .duration(1000)
	      .attr("x", 140)
	      .attr("y", function() {
	      	if (y_tooltip(rateById[d.id]) < 15) { return 10 }
	      		else { return y_tooltip(rateById[d.id]) - 7 }
	      	})
	
		tipSVG.append("text")
	      .text("per 100,000")
	      // .transition()
	      // .duration(1000)
	      .attr("x", 140)
	      .attr("y", function() {
	      	if (y_tooltip(rateById[d.id]) < 15) { return 24 }
	      		else { return y_tooltip(rateById[d.id]) + 7 }
	      	})
	
	    tipSVG.append("text")
	      .text(current_state)
	      // .transition()
	      // .duration(1000)
	      .attr("x", 0)
	      .attr("y", 15)
	      .style("font-size", 18)
	      .style("font-weight", 400)


	  })
  	  .on('mouseout', tool_tip.hide)
      .call(style, currentYear)

 // FOR BAR CHART //
   //    .on('mouseover', function(d) {
	  //   tool_tip.show();
	  //   var tipSVG = d3.select("#tipDiv")
	  //     .append("svg")
	  //     .attr("width", 200)
	  //     .attr("height", 50);

	  //   tipSVG.append("rect")
	  //     .attr("fill", color(rateById[d.id]))
	  //     .attr("y", 10)
	  //     .attr("width", 0)
	  //     .attr("height", 30)
	  //     .transition()
	  //     .duration(1000)
	  //     .attr("width", rateById[d.id] * 6);
	
	  //   tipSVG.append("text")
	  //     .text(rateById[d.id] + " per 100,000")
	  //     .attr("x", 10)
	  //     .attr("y", 30)
	  //     .transition()
	  //     .duration(1000)
	  //     .attr("x", 6 + rateById[d.id] * 6)
	  // })
  	//   .on('mouseout', tool_tip.hide)
   //    .call(style, currentYear)

    function style(states, year){
      newoverdoses = interpolateData(year);
    
    var rateById = {};
    var nameById = {};
    
    newoverdoses.forEach(function(d) {
    
      // each state is encoded according to its ANSI/FIPS state code
      // you can find states and their codes here https://en.wikipedia.org/wiki/List_of_U.S._state_abbreviations#ANSI_standard_INCITS_38:2009
      rateById[d.id] = +d.rate;
      nameById[d.id] = d.state;
      d.year = d.year;
      
    });
    
    // add fill according to death rates, for each id (state)
    states.style("fill", function(d) { return color(rateById[d.id]); })
    // OLD TOOLTIP // 
      // .on("mouseover", function(d) {      
      //     div.transition()        
      //       .duration(200)      
      //       .style("opacity", .9);  
    
      // // add tooltip here    
      //     div.html('<strong> State: </strong>' + nameById[d.id] + 
      //       '<br>' + 
      //       '<strong> Year: </strong>' + Math.round(currentYear) +
      //       '<br>' + 
      //       '<strong> Rate: </strong>' + rateById[d.id] + " per 100,000")
      //       .style("left", (d3.event.pageX) + "px")     
      //       .style("top", (d3.event.pageY - 28) + "px");})   
      //  // remove tooltip on mouse out               
      //  .on("mouseout", function(d) {       
      //     div.transition()        
      //      .duration(500)      
      //      .style("opacity", 0);});

  // create the actual state objects
  svg.append("path")
    .datum(topojson.mesh(us, us.objects.states, (a, b) => a !== b))
    .attr("fill", "none")
    .attr("stroke", "white")
    // .attr("stroke-linejoin", "round")
    .attr("d", path)
   }

  // after the transition finishes, mouseover to change  year.
  function enableInteraction() {
    var yearScale = d3.scaleLinear()
      .domain([1999, 2017])
      .range([box.x + 10, box.x + box.width - 10])
      .clamp(true);

    // Cancel the current transition, if any.
    svg.transition().duration(0);
    
    overlay
      .on("mouseover", mouseover)
      .on("mouseout", mouseout)
      .on("mousemove", mousemove)
      .on("touchmove", mousemove);
    
    function mouseover() { label.classed("active", true); }
    function mouseout() { label.classed("active", false); }
    function mousemove() { displayYear(yearScale.invert(d3.mouse(this)[0])); }
  }

  // Tweens the entire chart by first tweening the year, and then the data.
  // For the interpolated data, the dots and label are redrawn.
  function tweenYear() {
    var year = d3.interpolateNumber(1999, 2017);
    return function(t) { displayYear(year(t)); };
  }

  // Updates the display to show the specified year.
  function displayYear(year) {
    currentYear = year;
    states.call(style,year)
    label.text(Math.round(year));
  }

  // Interpolates the dataset for the given (fractional) year.
  function interpolateData(year) {
    return overdoses.filter(function(row) {
    return row['year'] == Math.round(year);
     });
    }
};
    </script> 

            </div>
              





<div class="article-tags">
  
  <a class="badge badge-light" href="/v2/tag/visualization/">visualization</a>
  
  <a class="badge badge-light" href="/v2/tag/interactive/">interactive</a>
  
  <a class="badge badge-light" href="/v2/tag/d3.js/">D3.js</a>
  
  <a class="badge badge-light" href="/v2/tag/tooltips/">tooltips</a>
  
</div>



<div class="share-box" aria-hidden="true">
  <ul class="share">
    
      
      
      
        
      
      
      
      <li>
        <a href="https://twitter.com/intent/tweet?url=https://connorrothschild.github.io/v2/post/adding-a-chart-to-your-d3-tooltip/&amp;text=How%20%28and%20Why%29%20to%20Add%20a%20Chart%20to%20Your%20D3.js%20Tooltip" target="_blank" rel="noopener" class="share-btn-twitter">
          <i class="fab fa-twitter"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.facebook.com/sharer.php?u=https://connorrothschild.github.io/v2/post/adding-a-chart-to-your-d3-tooltip/&amp;t=How%20%28and%20Why%29%20to%20Add%20a%20Chart%20to%20Your%20D3.js%20Tooltip" target="_blank" rel="noopener" class="share-btn-facebook">
          <i class="fab fa-facebook"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="mailto:?subject=How%20%28and%20Why%29%20to%20Add%20a%20Chart%20to%20Your%20D3.js%20Tooltip&amp;body=https://connorrothschild.github.io/v2/post/adding-a-chart-to-your-d3-tooltip/" target="_blank" rel="noopener" class="share-btn-email">
          <i class="fas fa-envelope"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://www.linkedin.com/shareArticle?url=https://connorrothschild.github.io/v2/post/adding-a-chart-to-your-d3-tooltip/&amp;title=How%20%28and%20Why%29%20to%20Add%20a%20Chart%20to%20Your%20D3.js%20Tooltip" target="_blank" rel="noopener" class="share-btn-linkedin">
          <i class="fab fa-linkedin-in"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://web.whatsapp.com/send?text=How%20%28and%20Why%29%20to%20Add%20a%20Chart%20to%20Your%20D3.js%20Tooltip%20https://connorrothschild.github.io/v2/post/adding-a-chart-to-your-d3-tooltip/" target="_blank" rel="noopener" class="share-btn-whatsapp">
          <i class="fab fa-whatsapp"></i>
        </a>
      </li>
    
      
      
      
        
      
      
      
      <li>
        <a href="https://service.weibo.com/share/share.php?url=https://connorrothschild.github.io/v2/post/adding-a-chart-to-your-d3-tooltip/&amp;title=How%20%28and%20Why%29%20to%20Add%20a%20Chart%20to%20Your%20D3.js%20Tooltip" target="_blank" rel="noopener" class="share-btn-weibo">
          <i class="fab fa-weibo"></i>
        </a>
      </li>
    
  </ul>
</div>












  
    
    





  
    
    
    
      
    
    
    
    <div class="media author-card content-widget-hr">
      
        
        <img class="avatar mr-3 avatar-circle" src="/v2/author/connor-rothschild/avatar_hu7fba9da1679ce4a56c592454604cb9c1_715589_270x270_fill_q100_lanczos_center.jpg" alt="Connor Rothschild">
      

      <div class="media-body">
        <h5 class="card-title"><a href="https://connorrothschild.github.io/v2/">Connor Rothschild</a></h5>
        <h6 class="card-subtitle">Undergraduate at Rice University</h6>
        <p class="card-text">I&rsquo;m a senior at Rice University interested in public policy, data science and their intersection. I&rsquo;m most passionate about translating complex data into informative and entertaining visualizations.</p>
        <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/v2/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/CL_Rothschild" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/connorrothschild" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
</ul>

      </div>
    </div>
  


  










  
  
  <div class="article-widget content-widget-hr">
    <h3>Related</h3>
    <ul>
      
      <li><a href="/v2/post/who-mentions-who-in-the-office/">Who Mentions Who in the Office?</a></li>
      
      <li><a href="/v2/post/building-my-first-shiny-app/">Building my First Shiny App</a></li>
      
      <li><a href="/v2/post/tidy-tuesday-replication/">Tidy Tuesday: Replication</a></li>
      
      <li><a href="/v2/post/map-springfield/">Creating a Streetmap of Springfield, MO</a></li>
      
      <li><a href="/v2/post/automation-scrollytell/">How to Scrollytell in R: Automation and Its Impact on Jobs</a></li>
      
    </ul>
  </div>
  


            </div>
              </article>
              

      

    
    
    
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js" integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js" integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin="anonymous"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js" integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin="anonymous"></script>

      

      
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js" integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin="anonymous"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/css.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/bash.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/javascript.min.js"></script>
        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/markdown.min.js"></script>
        
      

    

    
    

    
    
    <script>const code_highlighting = true;</script>
    

    
    
    <script>const isSiteThemeDark = false;</script>
    

    
    
    
    
    
    
    <script>
      const search_config = {"indexURI":"/v2/index.json","minLength":1,"threshold":0.3};
      const i18n = {"no_results":"No results found","placeholder":"Search...","results":"results found"};
      const content_type = {
        'post': "Posts",
        'project': "Projects",
        'publication' : "Publications",
        'talk' : "Talks"
        };
    </script>
    

    
    

    
    
    <script id="search-hit-fuse-template" type="text/x-template">
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script>
    

    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js" integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>
    

    
    

    
    

    
    

    
    
    
    
    
    
    
    
    
      
    
    
    
    
    <script src="/v2/js/academic.min.37431be2d92d7fb0160054761ab79602.js"></script>

    






  
  
  <div class="container">
    <footer class="site-footer">

    <p class="powered-by">
  
      © Connor Rothschild, 2021  | Browse the source code <a href="https://github.com/connorrothschild/connorrothschild.com" target ="_blank" rel="noopener">here</a>.
      <br>
      Built with <i class="far fa-heart"></i> and <i class="fa fa-coffee"></i> (and also 
      <a href="https://www.netlify.com/" target ="_blank" rel="noopener">Netlify</a>, 
      <a href="https://gohugo.io" target="_blank" rel="noopener">Hugo</a>,
      and the R <a href="https://github.com/rstudio/blogdown" target="_blank" rel="noopener">blogdown</a> package).
      
      </p>

      
 
  <script>
  $(document).ready(function () {
    window.initializeCodeFolding("show" === "hide");
  });
  </script>
  <script src="/v2/js/codefolding.js"></script>


    
 
  </footer>
  </div>
  

  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <pre><code class="tex hljs"></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>

</body>
</html>
