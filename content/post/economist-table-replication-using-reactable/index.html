---
title: "Recreating a Table by The Economist Using Reactable"
date: "2020-05-18"
authors: 
 - admin
categories: ["R"]
codefolding_show: show
image:
  preview_only: true
links:
 - name: ""
   url: https://github.com/connorrothschild/economist-table-replication
   icon_pack: fab
   icon: github
 - name: ""
   url: https://twitter.com/CL_Rothschild/status/1262793890144432128
   icon_pack: fab
   icon: twitter
tags: ["r", "visualization", "interactive", "reactable", "replication"]
summary: "Recreating a table by The Economist entirely in R, using {reactable}."
---

<script src="/v2/rmarkdown-libs/header-attrs/header-attrs.js"></script>
<link href="/v2/rmarkdown-libs/anchor-sections/anchor-sections.css" rel="stylesheet" />
<script src="/v2/rmarkdown-libs/anchor-sections/anchor-sections.js"></script>
<script src="/v2/rmarkdown-libs/core-js/shim.min.js"></script>
<script src="/v2/rmarkdown-libs/react/react.min.js"></script>
<script src="/v2/rmarkdown-libs/react/react-dom.min.js"></script>
<script src="/v2/rmarkdown-libs/reactwidget/react-tools.js"></script>
<script src="/v2/rmarkdown-libs/htmlwidgets/htmlwidgets.js"></script>
<script src="/v2/rmarkdown-libs/reactable-binding/reactable.js"></script>


<p><em>The Economist</em> recently released a series of country-level <a href="https://twitter.com/J_CD_T/status/1261625814854045696">datasets</a> on ‘excess mortality’, a term used to <a href="https://www.economist.com/graphic-detail/2020/04/16/tracking-covid-19-excess-deaths-across-countries">describe</a> ‘the gap between the total number of people who died from any cause, and the historical average for the same place and time of year.’ In simpler terms, the measure captures how many deaths <em>are</em> happening that <em>shouldn’t be</em>.</p>
<p>In the (free!) articles accompanying that data, I came across the following table:</p>
<div style="text-align:center">
<p><img width = 100% src = img/econ-table.png></p>
</div>
<p>I thought the table was clean and sent a clear message. The addition of inline barcharts is not intrusive but still helps the reader takeaway insights about the data. It’s a rather pretty table. Having recently <a href="https://twitter.com/dataandme/status/1196552930167599106">come across</a> Greg Lin’s package <a href="https://glin.github.io/reactable/index.html"><code>reactable</code></a>, I thought this could be a good opportunity to try my hand at recreating the above.</p>
<p>(Coincidentally, while I was working on this project, Malcolm Barrett released a similar <a href="https://malco.io/2020/05/16/replicating-an-nyt-table-of-swedish-covid-deaths-with-gt/">blog post</a> documenting his recreation of a NYT table using <code>gt</code>. Check it out!)</p>
<div id="loading-packages" class="section level2">
<h2>Loading packages</h2>
<p>Our process uses standard packages: <code>reactable</code> (obviously), <code>htmltools</code> as its buddy, <code>lubridate</code> for days and times, <code>hrbrthemes</code> for <em>The Economist’s</em> font, and <code>tidyverse</code> for general purpose data wrangling.</p>
<pre class="r"><code>library(reactable)
library(htmltools)
library(lubridate)
library(hrbrthemes)
library(tidyverse)</code></pre>
</div>
<div id="gather-the-data" class="section level2">
<h2>Gather the data</h2>
<p>You can definitely skip this step if you’re not interested in the data collection and cleaning process.</p>
<p>Unfortunately, one of the more time-consuming steps of this project was getting the data in the same format <em>The Economist</em> used in their article. The data they released comes in the form of a series of <a href="https://github.com/TheEconomist/covid-19-excess-deaths-tracker/tree/master/output-data/excess-deaths">country-level CSVs</a>; although helpful for country-level analysis, this meant that we have to modify the data into a joined format in order to create a table.</p>
<p>Let’s begin by creating a function which reads in <strong>each individual CSV</strong>, selects relevant columns, and stores that specific dataframe in the global environment.</p>
<pre class="r"><code>create_dataframe &lt;- function(country) {
  ## for URL (below)
  country &lt;- str_replace(country, &quot; &quot;, &quot;_&quot;)
  
  ## read in CSV, given country parameter
  data &lt;-
    readr::read_csv(
      paste0(
        &#39;https://raw.githubusercontent.com/TheEconomist/covid-19-excess-deaths-tracker/master/output-data/excess-deaths/&#39;, country, &#39;_excess_deaths.csv&#39;
      )
    )
  
  ## select relevant columns
  data &lt;- data %&gt;%
    select(
      country,
      region,
      start_date,
      end_date,
      population,
      total_deaths,
      covid_deaths,
      expected_deaths,
      excess_deaths,
      non_covid_deaths
    )
  
  assign(country, rbind(data), envir = .GlobalEnv)
}</code></pre>
<p>With that function created, we then want to loop it with each country <em>The Economist</em> has included.</p>
<p>To do so, we grab their list of sources from GitHub and pull each country into a list:</p>
<pre class="r"><code>country_names &lt;-
  readr::read_csv(
    &#39;https://raw.githubusercontent.com/TheEconomist/covid-19-excess-deaths-tracker/master/source-data/list_of_sources.csv&#39;
  ) %&gt;%
  select(country) %&gt;%
  distinct() %&gt;%
  mutate(country = stringr::str_to_lower(country)) %&gt;%
  filter(country != &#39;all&#39;) %&gt;%
  pull()</code></pre>
<p>Then, we loop!</p>
<pre class="r"><code>for (country in country_names) {
  tryCatch({create_dataframe(country)},
           error = function(e) {
             return(NULL)
           })
}</code></pre>
<p>Now, we have a list of dataframes, with each containing one country’s data on excess mortality.</p>
<p>Finally, we merge each of these new dataframes into one master dataset. Here, we are defining in <code>dfs</code> a list of all objects in the global environment that are of the structure data frame. Then, we <code>rbind</code> them all together!</p>
<pre class="r"><code>dfs = sapply(.GlobalEnv, is.data.frame)

data &lt;- do.call(rbind, mget(names(dfs)[dfs]))</code></pre>
<p>But unfortunately, that’s not all. We need to filter our data to only include the places that are in <em>The Economist’s</em> table. To make matters more difficult, the table’s identifying row is titled ‘Region/Country’, and includes data from two <em>separate</em> rows in the CSVs.</p>
<p>Let’s begin by manually defining and filtering according to the countries and regions that <em>The Economist</em> includes. (This selection does not seem to have an order to it; as such, it has to be manual).</p>
<pre class="r"><code>good_countries &lt;-
  c(&quot;Britain&quot;,
    &quot;Spain&quot;,
    &quot;Italy&quot;,
    &quot;France&quot;,
    &quot;Netherlands&quot;,
    &quot;Belgium&quot;,
    &quot;Sweden&quot;,
    &quot;Austria&quot;)

good_regions &lt;- c(&quot;New York City&quot;, &quot;Istanbul&quot;, &quot;Jakarta&quot;)

data_filtered_countries &lt;- data %&gt;%
  filter(country %in% good_countries) %&gt;%
  filter(country == region)</code></pre>
<p>Because the table only has one row for country/region, and groups them accordingly, we can go ahead and replace the <code>country</code> variable in the <code>data_filtered_regions</code> dataframe with <code>region</code>.</p>
<pre class="r"><code>data_filtered_regions &lt;- data %&gt;%
  filter(region %in% good_regions) %&gt;%
  # replace for the sake of the table
  mutate(country = region)</code></pre>
<p>And merge:</p>
<pre class="r"><code>data_filtered &lt;-
  rbind(data_filtered_countries, data_filtered_regions)</code></pre>
<p>Next, we notice that the table title says ‘Excess mortality <em>since region/country’s first 50 covid deaths</em>.’ This means we need to exclude counts of excess deaths <em>before</em> a region had 50 COVID deaths.</p>
<pre class="r"><code>data_filtered &lt;- data_filtered %&gt;%
  group_by(country) %&gt;%
  mutate(csum = cumsum(covid_deaths))</code></pre>
<p>At this point (after only selecting our relevant columns), our data looks like this:</p>
<pre class="r"><code>data_filtered %&gt;% 
  select(country, start_date, end_date, covid_deaths, excess_deaths, covid_deaths, csum) %&gt;% 
  reactable()</code></pre>
<div id="htmlwidget-1" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-1">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"country":["Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Belgium","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Britain","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Sweden","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Netherlands","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","Spain","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","France","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Austria","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","Italy","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","New York City","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Istanbul","Jakarta","Jakarta","Jakarta","Jakarta","Jakarta"],"start_date":["2019-12-30","2020-01-06","2020-01-13","2020-01-20","2020-01-27","2020-02-03","2020-02-10","2020-02-17","2020-02-24","2020-03-02","2020-03-09","2020-03-16","2020-03-23","2020-03-30","2020-04-06","2020-04-13","2020-04-20","2020-04-27","2020-05-04","2020-05-11","2020-05-18","2020-05-25","2020-06-01","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-08-03","2020-08-10","2020-08-17","2020-08-24","2020-08-31","2020-09-07","2020-09-14","2020-09-21","2020-09-28","2020-10-05","2020-10-12","2020-10-19","2020-10-26","2020-11-02","2020-11-09","2020-11-16","2020-11-23","2020-11-30","2020-12-07","2020-12-14","2020-12-21","2019-12-28","2020-01-04","2020-01-11","2020-01-18","2020-01-25","2020-02-01","2020-02-08","2020-02-15","2020-02-22","2020-02-29","2020-03-07","2020-03-14","2020-03-21","2020-03-28","2020-04-04","2020-04-11","2020-04-18","2020-04-25","2020-05-02","2020-05-09","2020-05-16","2020-05-23","2020-05-30","2020-06-06","2020-06-13","2020-06-20","2020-06-27","2020-07-04","2020-07-11","2020-07-18","2020-07-25","2020-08-01","2020-08-08","2020-08-15","2020-08-22","2020-08-29","2020-09-05","2020-09-12","2020-09-19","2020-09-26","2020-10-03","2020-10-10","2020-10-17","2020-10-24","2020-10-31","2020-11-07","2020-11-14","2020-11-21","2020-11-28","2020-12-05","2020-12-12","2020-12-19","2020-12-26","2021-01-02","2019-12-30","2020-01-06","2020-01-13","2020-01-20","2020-01-27","2020-02-03","2020-02-10","2020-02-17","2020-02-24","2020-03-02","2020-03-09","2020-03-16","2020-03-23","2020-03-30","2020-04-06","2020-04-13","2020-04-20","2020-04-27","2020-05-04","2020-05-11","2020-05-18","2020-05-25","2020-06-01","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-08-03","2020-08-10","2020-08-17","2020-08-24","2020-08-31","2020-09-07","2020-09-14","2020-09-21","2020-09-28","2020-10-05","2020-10-12","2020-10-19","2020-10-26","2020-11-02","2020-11-09","2020-11-16","2020-11-23","2020-11-30","2020-12-07","2020-12-14","2020-12-21","2019-12-30","2020-01-06","2020-01-13","2020-01-20","2020-01-27","2020-02-03","2020-02-10","2020-02-17","2020-02-24","2020-03-02","2020-03-09","2020-03-16","2020-03-23","2020-03-30","2020-04-06","2020-04-13","2020-04-20","2020-04-27","2020-05-04","2020-05-11","2020-05-18","2020-05-25","2020-06-01","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-08-03","2020-08-10","2020-08-17","2020-08-24","2020-08-31","2020-09-07","2020-09-14","2020-09-21","2020-09-28","2020-10-05","2020-10-12","2020-10-19","2020-10-26","2020-11-02","2020-11-09","2020-11-16","2020-11-23","2020-11-30","2020-12-07","2020-12-14","2020-12-21","2020-12-28","2021-01-04","2020-01-01","2020-01-08","2020-01-15","2020-01-22","2020-01-29","2020-02-05","2020-02-12","2020-02-19","2020-02-26","2020-03-04","2020-03-11","2020-03-18","2020-03-25","2020-04-01","2020-04-08","2020-04-15","2020-04-22","2020-04-29","2020-05-06","2020-05-13","2020-05-20","2020-05-27","2020-06-03","2020-06-10","2020-06-17","2020-06-24","2020-07-01","2020-07-08","2020-07-15","2020-07-22","2020-07-29","2020-08-05","2020-08-12","2020-08-19","2020-08-26","2020-09-02","2020-09-09","2020-09-16","2020-09-23","2020-09-30","2020-10-07","2020-10-14","2020-10-21","2020-10-28","2020-11-04","2020-11-11","2020-11-18","2020-11-25","2020-12-02","2020-12-09","2020-12-16","2020-12-23","2020-12-30","2021-01-01","2021-01-08","2020-01-01","2020-01-08","2020-01-15","2020-01-22","2020-01-29","2020-02-05","2020-02-12","2020-02-19","2020-02-26","2020-03-04","2020-03-11","2020-03-18","2020-03-25","2020-04-01","2020-04-08","2020-04-15","2020-04-22","2020-04-29","2020-05-06","2020-05-13","2020-05-20","2020-05-27","2020-06-03","2020-06-10","2020-06-17","2020-06-24","2020-07-01","2020-07-08","2020-07-15","2020-07-22","2020-07-29","2020-08-05","2020-08-12","2020-08-19","2020-08-26","2020-09-02","2020-09-09","2020-09-16","2020-09-23","2020-09-30","2020-10-07","2020-10-14","2020-10-21","2020-10-28","2020-11-04","2020-11-11","2020-11-18","2020-11-25","2019-12-30","2020-01-06","2020-01-13","2020-01-20","2020-01-27","2020-02-03","2020-02-10","2020-02-17","2020-02-24","2020-03-02","2020-03-09","2020-03-16","2020-03-23","2020-03-30","2020-04-06","2020-04-13","2020-04-20","2020-04-27","2020-05-04","2020-05-11","2020-05-18","2020-05-25","2020-06-01","2020-06-08","2020-06-15","2020-06-22","2020-06-29","2020-07-06","2020-07-13","2020-07-20","2020-07-27","2020-08-03","2020-08-10","2020-08-17","2020-08-24","2020-08-31","2020-09-07","2020-09-14","2020-09-21","2020-09-28","2020-10-05","2020-10-12","2020-10-19","2020-10-26","2020-11-02","2020-11-09","2020-11-16","2020-11-23","2020-11-30","2020-12-07","2020-12-14","2020-12-21","2020-12-28","2020-01-01","2020-01-08","2020-01-15","2020-01-22","2020-01-29","2020-02-05","2020-02-12","2020-02-19","2020-02-26","2020-03-04","2020-03-11","2020-03-18","2020-03-25","2020-04-01","2020-04-08","2020-04-15","2020-04-22","2020-04-29","2020-05-06","2020-05-13","2020-05-20","2020-05-27","2020-06-03","2020-06-10","2020-06-17","2020-06-24","2020-07-01","2020-07-08","2020-07-15","2020-07-22","2020-07-29","2020-08-05","2020-08-12","2020-08-19","2020-08-26","2020-09-02","2020-09-09","2020-09-16","2020-09-23","2020-09-30","2020-10-07","2020-10-14","2020-10-21","2019-12-29","2020-01-05","2020-01-12","2020-01-19","2020-01-26","2020-02-02","2020-02-09","2020-02-16","2020-02-23","2020-03-01","2020-03-08","2020-03-15","2020-03-22","2020-03-29","2020-04-05","2020-04-12","2020-04-19","2020-04-26","2020-05-03","2020-05-10","2020-05-17","2020-05-24","2020-05-31","2020-06-07","2020-06-14","2020-06-21","2020-06-28","2020-07-05","2020-07-12","2020-07-19","2020-07-26","2020-08-02","2020-08-09","2020-08-16","2020-08-23","2020-08-30","2020-09-06","2020-09-13","2020-09-20","2020-09-27","2020-10-04","2020-10-11","2020-10-18","2020-10-25","2020-11-01","2020-11-08","2020-11-15","2020-11-22","2020-11-29","2020-12-06","2020-12-13","2020-12-20","2020-12-27","2020-01-01","2020-01-08","2020-01-15","2020-01-22","2020-01-29","2020-02-05","2020-02-12","2020-02-19","2020-02-26","2020-03-04","2020-03-11","2020-03-18","2020-03-25","2020-04-01","2020-04-08","2020-04-15","2020-04-22","2020-04-29","2020-05-06","2020-05-13","2020-05-20","2020-05-27","2020-06-03","2020-06-10","2020-06-17","2020-06-24","2020-07-01","2020-07-08","2020-07-15","2020-07-22","2020-07-29","2020-08-05","2020-08-12","2020-08-19","2020-08-26","2020-09-02","2020-09-09","2020-09-16","2020-09-23","2020-09-30","2020-10-07","2020-10-14","2020-10-21","2020-10-28","2020-11-04","2020-11-11","2020-01-01","2020-02-01","2020-03-01","2020-04-01","2020-05-01"],"end_date":["2020-01-05","2020-01-12","2020-01-19","2020-01-26","2020-02-02","2020-02-09","2020-02-16","2020-02-23","2020-03-01","2020-03-08","2020-03-15","2020-03-22","2020-03-29","2020-04-05","2020-04-12","2020-04-19","2020-04-26","2020-05-03","2020-05-10","2020-05-17","2020-05-24","2020-05-31","2020-06-07","2020-06-14","2020-06-21","2020-06-28","2020-07-05","2020-07-12","2020-07-19","2020-07-26","2020-08-02","2020-08-09","2020-08-16","2020-08-23","2020-08-30","2020-09-06","2020-09-13","2020-09-20","2020-09-27","2020-10-04","2020-10-11","2020-10-18","2020-10-25","2020-11-01","2020-11-08","2020-11-15","2020-11-22","2020-11-29","2020-12-06","2020-12-13","2020-12-20","2020-12-27","2020-01-03","2020-01-10","2020-01-17","2020-01-24","2020-01-31","2020-02-07","2020-02-14","2020-02-21","2020-02-28","2020-03-06","2020-03-13","2020-03-20","2020-03-27","2020-04-03","2020-04-10","2020-04-17","2020-04-24","2020-05-01","2020-05-08","2020-05-15","2020-05-22","2020-05-29","2020-06-05","2020-06-12","2020-06-19","2020-06-26","2020-07-03","2020-07-10","2020-07-17","2020-07-24","2020-07-31","2020-08-07","2020-08-14","2020-08-21","2020-08-28","2020-09-04","2020-09-11","2020-09-18","2020-09-25","2020-10-02","2020-10-09","2020-10-16","2020-10-23","2020-10-30","2020-11-06","2020-11-13","2020-11-20","2020-11-27","2020-12-04","2020-12-11","2020-12-18","2020-12-25","2021-01-01","2021-01-08","2020-01-05","2020-01-12","2020-01-19","2020-01-26","2020-02-02","2020-02-09","2020-02-16","2020-02-23","2020-03-01","2020-03-08","2020-03-15","2020-03-22","2020-03-29","2020-04-05","2020-04-12","2020-04-19","2020-04-26","2020-05-03","2020-05-10","2020-05-17","2020-05-24","2020-05-31","2020-06-07","2020-06-14","2020-06-21","2020-06-28","2020-07-05","2020-07-12","2020-07-19","2020-07-26","2020-08-02","2020-08-09","2020-08-16","2020-08-23","2020-08-30","2020-09-06","2020-09-13","2020-09-20","2020-09-27","2020-10-04","2020-10-11","2020-10-18","2020-10-25","2020-11-01","2020-11-08","2020-11-15","2020-11-22","2020-11-29","2020-12-06","2020-12-13","2020-12-20","2020-12-27","2020-01-05","2020-01-12","2020-01-19","2020-01-26","2020-02-02","2020-02-09","2020-02-16","2020-02-23","2020-03-01","2020-03-08","2020-03-15","2020-03-22","2020-03-29","2020-04-05","2020-04-12","2020-04-19","2020-04-26","2020-05-03","2020-05-10","2020-05-17","2020-05-24","2020-05-31","2020-06-07","2020-06-14","2020-06-21","2020-06-28","2020-07-05","2020-07-12","2020-07-19","2020-07-26","2020-08-02","2020-08-09","2020-08-16","2020-08-23","2020-08-30","2020-09-06","2020-09-13","2020-09-20","2020-09-27","2020-10-04","2020-10-11","2020-10-18","2020-10-25","2020-11-01","2020-11-08","2020-11-15","2020-11-22","2020-11-29","2020-12-06","2020-12-13","2020-12-20","2020-12-27","2021-01-03","2021-01-10","2020-01-07","2020-01-14","2020-01-21","2020-01-28","2020-02-04","2020-02-11","2020-02-18","2020-02-25","2020-03-03","2020-03-10","2020-03-17","2020-03-24","2020-03-31","2020-04-07","2020-04-14","2020-04-21","2020-04-28","2020-05-05","2020-05-12","2020-05-19","2020-05-26","2020-06-02","2020-06-09","2020-06-16","2020-06-23","2020-06-30","2020-07-07","2020-07-14","2020-07-21","2020-07-28","2020-08-04","2020-08-11","2020-08-18","2020-08-25","2020-09-01","2020-09-08","2020-09-15","2020-09-22","2020-09-29","2020-10-06","2020-10-13","2020-10-20","2020-10-27","2020-11-03","2020-11-10","2020-11-17","2020-11-24","2020-12-01","2020-12-08","2020-12-15","2020-12-22","2020-12-29","2020-12-31","2021-01-07","2021-01-14","2020-01-07","2020-01-14","2020-01-21","2020-01-28","2020-02-04","2020-02-11","2020-02-18","2020-02-25","2020-03-03","2020-03-10","2020-03-17","2020-03-24","2020-03-31","2020-04-07","2020-04-14","2020-04-21","2020-04-28","2020-05-05","2020-05-12","2020-05-19","2020-05-26","2020-06-02","2020-06-09","2020-06-16","2020-06-23","2020-06-30","2020-07-07","2020-07-14","2020-07-21","2020-07-28","2020-08-04","2020-08-11","2020-08-18","2020-08-25","2020-09-01","2020-09-08","2020-09-15","2020-09-22","2020-09-29","2020-10-06","2020-10-13","2020-10-20","2020-10-27","2020-11-03","2020-11-10","2020-11-17","2020-11-24","2020-12-01","2020-01-05","2020-01-12","2020-01-19","2020-01-26","2020-02-02","2020-02-09","2020-02-16","2020-02-23","2020-03-01","2020-03-08","2020-03-15","2020-03-22","2020-03-29","2020-04-05","2020-04-12","2020-04-19","2020-04-26","2020-05-03","2020-05-10","2020-05-17","2020-05-24","2020-05-31","2020-06-07","2020-06-14","2020-06-21","2020-06-28","2020-07-05","2020-07-12","2020-07-19","2020-07-26","2020-08-02","2020-08-09","2020-08-16","2020-08-23","2020-08-30","2020-09-06","2020-09-13","2020-09-20","2020-09-27","2020-10-04","2020-10-11","2020-10-18","2020-10-25","2020-11-01","2020-11-08","2020-11-15","2020-11-22","2020-11-29","2020-12-06","2020-12-13","2020-12-20","2020-12-27","2021-01-03","2020-01-07","2020-01-14","2020-01-21","2020-01-28","2020-02-04","2020-02-11","2020-02-18","2020-02-25","2020-03-03","2020-03-10","2020-03-17","2020-03-24","2020-03-31","2020-04-07","2020-04-14","2020-04-21","2020-04-28","2020-05-05","2020-05-12","2020-05-19","2020-05-26","2020-06-02","2020-06-09","2020-06-16","2020-06-23","2020-06-30","2020-07-07","2020-07-14","2020-07-21","2020-07-28","2020-08-04","2020-08-11","2020-08-18","2020-08-25","2020-09-01","2020-09-08","2020-09-15","2020-09-22","2020-09-29","2020-10-06","2020-10-13","2020-10-20","2020-10-27","2020-01-04","2020-01-11","2020-01-18","2020-01-25","2020-02-01","2020-02-08","2020-02-15","2020-02-22","2020-02-29","2020-03-07","2020-03-14","2020-03-21","2020-03-28","2020-04-04","2020-04-11","2020-04-18","2020-04-25","2020-05-02","2020-05-09","2020-05-16","2020-05-23","2020-05-30","2020-06-06","2020-06-13","2020-06-20","2020-06-27","2020-07-04","2020-07-11","2020-07-18","2020-07-25","2020-08-01","2020-08-08","2020-08-15","2020-08-22","2020-08-29","2020-09-05","2020-09-12","2020-09-19","2020-09-26","2020-10-03","2020-10-10","2020-10-17","2020-10-24","2020-10-31","2020-11-07","2020-11-14","2020-11-21","2020-11-28","2020-12-05","2020-12-12","2020-12-19","2020-12-26","2021-01-02","2020-01-08","2020-01-15","2020-01-22","2020-01-29","2020-02-05","2020-02-12","2020-02-19","2020-02-26","2020-03-04","2020-03-11","2020-03-18","2020-03-25","2020-04-01","2020-04-08","2020-04-15","2020-04-22","2020-04-29","2020-05-06","2020-05-13","2020-05-20","2020-05-27","2020-06-03","2020-06-10","2020-06-17","2020-06-24","2020-07-01","2020-07-08","2020-07-15","2020-07-22","2020-07-29","2020-08-05","2020-08-12","2020-08-19","2020-08-26","2020-09-02","2020-09-09","2020-09-16","2020-09-23","2020-09-30","2020-10-07","2020-10-14","2020-10-21","2020-10-28","2020-11-04","2020-11-11","2020-11-18","2020-01-31","2020-02-29","2020-03-31","2020-04-30","2020-05-31"],"covid_deaths":[0,0,0,0,0,0,0,0,0,0,4,71,356,1016,2153,2083,1411,750,812,396,228,187,128,60,41,36,39,11,18,21,24,27,67,53,-98,13,18,23,32,84,127,222,397,927,1318,1366,1197,929,773,631,675,574,0,0,0,0,0,0,0,0,0,0,5,115,610,3812,6898,9509,9026,6686,4429,4220,2872,2002,1697,1204,849,653,561,388,303,232,201,162,146,150,112,83,111,158,234,343,474,762,1126,1598,2226,2841,3043,3373,3165,3069,3276,3200,3425,6593,0,0,0,0,0,0,0,0,0,0,7,53,224,117,498,641,654,485,546,454,319,397,264,215,179,227,140,106,93,78,46,20,20,27,11,14,11,19,15,15,-1,24,15,5,84,142,242,275,386,447,479,286,0,0,0,0,0,0,0,0,0,3,17,160,592,999,976,950,794,581,387,240,142,134,57,46,31,15,22,10,-1,23,-9,9,16,31,27,25,15,32,99,85,134,169,297,390,574,487,408,459,342,366,444,512,617,754,0,0,0,0,0,0,1,0,1,68,787,3475,6097,5568,4489,3212,2098,1418,951,519,441,293,202,144,98,64,30,20,30,49,83,157,202,309,391,518,698,798,897,872,937,1034,1386,1705,2051,2062,1801,1536,1196,1106,960,950,289,1016,1163,0,0,0,0,0,0,1,0,3,29,116,953,2424,6804,5382,5057,2865,1903,1457,1031,573,345,358,252,169,124,90,101,132,58,73,58,98,97,120,100,240,417,468,488,569,957,1655,3198,3516,4069,3972,3274,0,0,0,0,0,0,0,0,0,0,1,15,70,118,146,102,90,56,20,11,11,28,4,5,13,12,4,2,3,1,6,3,7,4,1,3,20,10,21,26,38,42,86,151,281,418,559,717,735,633,878,530,443,0,0,0,0,0,0,0,10,69,552,1857,4238,5462,4521,3834,3478,2654,1921,1580,1247,780,573,511,361,269,153,132,85,89,50,48,44,190,40,46,72,70,105,136,155,210,450,981,0,0,0,0,0,0,0,0,0,0,4,175,1205,3807,5315,4237,2849,1865,1164,711,494,349,276,216,133,129,88,65,74,59,45,32,30,28,33,29,25,30,29,39,28,49,32,45,80,61,77,94,153,187,245,293,327,0,0,0,0,0,0,0,0,0,0,0.5,21.5,85,255.5,339,428,366.5,264,187,152.5,99,94,72,56.5,79.5,65,64.5,71,62,59.5,60,54,71.5,73.5,127,182.5,202,226.5,245.5,211.5,202,244,252.5,265.5,289,322.5,0,0,84,297,139],"excess_deaths":[-113.76240636715,-9.76240636708098,-67.429073033747,-158.762406367081,-97.5957397004149,-241.262406367081,-154.762406367082,-128.262406367081,-267.914887640492,-203.914887640492,-76.7148876404931,267.685112359507,989.085112359507,1924.28511235951,2212.68511235951,1670.48511235951,1023.68511235951,423.685112359509,371.685112359508,79.6851123595088,121.685112359507,67.4851123595067,-65.1148876404932,53.2851123595069,-88.7148876404949,82.8851123595075,-239.314887640492,-162.914887640494,-38.9148876404904,-173.914887640492,77.4851123595067,179.485112359508,1037.68511235951,318.08511235951,-21.1148876404932,53.8851123595082,-34.5148876404933,127.085112359508,13.2851123595085,-38.1148876404925,48.8851123595077,159.885112359508,643.085112359508,1300.48511235951,1679.28511235951,1383.88511235951,1075.08511235951,787.685112359508,522.285112359507,554.885112359508,458.285112359508,320.485112359508,49.5691169724359,312.235783639129,-234.430883027691,-853.597549694136,-592.930883027662,-784.9308830275,-634.430883027135,-693.597549693932,-269.430883027613,-649.517059632846,-119.517059633001,119.682940367109,987.282940366724,6883.28294036692,9065.28294036689,12846.2829403668,12486.6829403668,8767.88294036698,3546.88294036679,4885.0829403666,2570.68294036695,1846.28294036712,818.882940367215,610.082940366901,18.6829403668326,-296.717059632927,-43.9170596334425,-548.517059633365,-236.917059633459,-140.117059633389,-14.1170596330612,-90.51705963327,256.682940366883,585.082940366541,912.682940366796,-1377.51705963325,593.482940366637,278.882940366713,207.682940366671,603.282940366727,216.082940366774,738.882940366688,1247.88294036671,1311.88294036668,1726.28294036672,2234.88294036682,2485.68294036676,2367.68294036682,1849.2829403667,1641.08294036675,1533.28294036676,3778.68294036678,2423.64771151861,6328.06343042785,-86.3876404496259,-12.3876404494627,-58.8876404494622,-119.05430711613,7.61235955053644,-94.5543071161292,-44.7209737827964,-138.05430711613,-150.265168539345,-40.2651685393455,-121.065168539346,115.734831460657,268.134831460654,627.934831460655,870.734831460655,812.534831460655,621.334831460654,638.734831460656,593.534831460656,464.734831460657,404.334831460655,142.734831460654,262.734831460655,244.734831460654,181.334831460653,162.134831460655,33.3348314606549,53.1348314606537,-10.8651685393436,27.1348314606548,12.334831460654,90.1348314606553,38.1348314606544,87.9348314606561,-53.8651685393456,-5.86516853934518,24.1348314606539,-9.06516853934454,18.334831460656,-44.4651685393453,-61.0651685393448,33.5348314606551,-53.6651685393454,42.3348314606549,57.7348314606543,225.934831460655,365.534831460655,262.934831460655,396.734831460655,397.134831460655,496.134831460655,310.934831460655,-195.753511235732,-36.7535112359151,-157.086844569248,-288.586844569249,-169.086844569249,-126.753511235915,-158.920177902582,-404.586844569249,-267.304213483111,-289.104213483111,-28.3042134831121,491.495786516891,1360.49578651689,2116.49578651689,2077.89578651689,1418.89578651689,1055.29578651689,592.295786516891,147.09578651689,-3.5042134831092,-5.10421348311093,-38.3042134831121,-18.7042134831117,5.6957865168888,22.0957865168862,-56.1042134831118,-156.104213483111,-71.5042134831133,-185.504213483109,-70.504213483111,12.2957865168878,-44.10421348311,580.695786516887,197.295786516891,73.4957865168881,66.495786516889,39.4957865168876,37.2957865168901,141.09578651689,222.095786516889,149.495786516889,405.895786516889,591.495786516889,830.095786516889,688.695786516888,666.895786516889,366.295786516889,441.295786516889,497.095786516888,468.495786516889,768.695786516889,754.895786516889,1002.82865168543,636.745084269875,-616.5,-40,200,363.75,397.25,-436.5,-616,-604,-435.75,-185,1479.25,6098.75,11501.25,10674.75,7092.5,4136.5,1966.25,1113.75,392.75,-147.25,236.75,133.75,-483.25,-368.5,-200.5,8.75,92.25,140,220.5,463,1218.25,995.5,639.75,767.5,611,766.5,1172.5,1090.25,857.5,893,1176.5,1443.5,1829.5,2067.25,2407,1943,1496.75,1212,1243.25,1158.75,496,339,191.25,173,1249.5,-505.472916666806,-560.472916666762,-690.639583333379,-693.306250000114,-594.63958333345,-853.639583333423,-787.472916666748,-1080.97291666678,-797.967500000064,-422.967500000106,862.632499999883,2317.83249999986,5594.63249999989,7286.63249999988,5557.63249999983,3385.83249999987,1467.2324999999,228.2324999999,35.032499999852,371.032499999888,269.832499999902,-62.5675000000265,27.2324999999128,223.032499999876,134.232499999878,110.03249999989,-642.167500000118,-13.5675000001102,-343.967499999992,33.0324999998866,337.032499999847,1070.43249999989,1089.83249999986,135.832499999882,-63.3675000001385,582.232499999907,978.432499999839,810.232499999876,307.032499999872,906.432499999872,603.432499999883,1328.63249999989,2639.43249999989,3782.8324999999,4376.83249999989,3877.23249999988,3339.4324999999,2755.43249999986,-173.571629213423,-137.738295880124,0.261704119877095,18.0950374532099,98.4283707865429,-138.40496254679,-85.0716292134573,-95.238295880124,-57.8859550561506,-19.8859550561513,-3.68595505615144,227.71404494385,108.914044943849,232.314044943849,236.51404494385,170.314044943849,107.514044943849,5.11404494385033,70.3140449438501,15.7140449438502,49.114044943849,-6.68595505615144,67.3140449438488,7.31404494384878,-4.8859550561524,26.9140449438487,115.51404494385,-4.6859550561519,-37.0859550561497,-47.0859550561506,11.9140449438487,-3.48595505615026,136.114044943849,32.9140449438505,60.9140449438485,135.51404494385,132.914044943848,135.71404494385,50.1140449438499,63.3140449438492,94.7140449438493,102.514044943849,257.714044943849,371.714044943849,485.314044943849,722.314044943849,860.714044943849,874.51404494385,926.714044943849,839.914044943849,586.114044943849,368.51404494385,250.404494382054,-1378.99319727916,-1401.99319727921,-1190.65986394581,-625.159863945832,-945.493197279171,-709.15986394581,-534.826530612478,-194.65986394581,-55.1918367349244,2123.00816326494,5946.00816326503,9938.40816326495,10311.6081632651,7745.40816326497,6199.20816326515,4139.20816326502,2526.60816326508,1257.80816326516,854.40816326508,782.008163265056,56.4081632650286,-221.991836734936,-309.79183673497,-411.991836734909,429.208163265021,876.608163265133,535.808163265005,-399.391836734907,-428.191836734917,-241.391836734954,1502.40816326509,-246.591836734895,1152.00816326503,756.408163265027,551.008163265025,680.608163265038,1057.40816326508,813.80816326507,246.008163265067,849.408163265032,488.008163265029,1314.60816326509,2826.20816326507,-59.4260808928029,-37.0927475588328,-28.5927475599021,-3.42608089255737,23.5739191068901,-15.0927475596063,-6.92608089265605,-17.5927475595215,1.57391910704473,20.8887029285156,36.8887029284717,351.088702928393,1755.48870292846,5244.88870292856,6790.48870292861,4875.88870292876,3046.88870292847,1851.48870292833,1074.08870292856,602.888702928624,289.888702928943,201.888702928574,142.688702928356,130.488702928604,-2.31129707171294,102.488702928747,-5.71129707127398,53.0887029287928,-6.71129707145656,55.2887029286996,5.688702928628,6.28870292865531,-15.9112970714262,7.28870292878207,49.6887029287209,8.08870292853726,2.28870292879151,48.2887029286215,15.4887029287393,-66.111297071363,-4.31129707139962,2.08870292869096,10.0887029286484,34.2887029286726,127.488702928733,47.4887029287595,82.0887029284947,12.4887029286622,118.488702928673,174.088702928732,276.288702928689,294.488702928703,270.488702928459,-63.2950000000019,-30.2949999999562,-0.294999999956417,7.20500000004313,-28.0449999999564,-6.29499999995687,-1.04499999995619,-75.7949999999562,-70.0599999999367,-61.0599999999367,71.2733333333981,271.606666666729,432.940000000064,792.273333333396,778.940000000062,603.273333333396,465.273333333397,346.940000000063,290.273333333397,86.2733333333967,20.9400000000642,44.2733333333979,85.2733333333963,115.940000000063,43.9400000000639,-64.3933333332711,73.2733333333972,-22.0599999999358,-5.72666666660348,5.60666666673069,39.6066666667302,166.273333333397,74.60666666673,85.2733333333967,142.273333333397,128.606666666731,84.6066666667296,201.940000000063,130.940000000063,107.273333333397,153.940000000064,160.60666666673,481.60666666673,579.273333333397,947.273333333397,1235.60666666673,351.66021711342,-121.189981225617,1317.49032567027,1526.36160548736,1448.99032567027],"csum":[0,0,0,0,0,0,0,0,0,0,4,75,431,1447,3600,5683,7094,7844,8656,9052,9280,9467,9595,9655,9696,9732,9771,9782,9800,9821,9845,9872,9939,9992,9894,9907,9925,9948,9980,10064,10191,10413,10810,11737,13055,14421,15618,16547,17320,17951,18626,19200,0,0,0,0,0,0,0,0,0,0,5,120,730,4542,11440,20949,29975,36661,41090,45310,48182,50184,51881,53085,53934,54587,55148,55536,55839,56071,56272,56434,56580,56730,56842,56925,57036,57194,57428,57771,58245,59007,60133,61731,63957,66798,69841,73214,76379,79448,82724,85924,89349,95942,0,0,0,0,0,0,0,0,0,0,7,60,284,401,899,1540,2194,2679,3225,3679,3998,4395,4659,4874,5053,5280,5420,5526,5619,5697,5743,5763,5783,5810,5821,5835,5846,5865,5880,5895,5894,5918,5933,5938,6022,6164,6406,6681,7067,7514,7993,8279,0,0,0,0,0,0,0,0,0,3,20,180,772,1771,2747,3697,4491,5072,5459,5699,5841,5975,6032,6078,6109,6124,6146,6156,6155,6178,6169,6178,6194,6225,6252,6277,6292,6324,6423,6508,6642,6811,7108,7498,8072,8559,8967,9426,9768,10134,10578,11090,11707,12461,0,0,0,0,0,0,1,1,2,70,857,4332,10429,15997,20486,23698,25796,27214,28165,28684,29125,29418,29620,29764,29862,29926,29956,29976,30006,30055,30138,30295,30497,30806,31197,31715,32413,33211,34108,34980,35917,36951,38337,40042,42093,44155,45956,47492,48688,49794,50754,51704,51993,53009,54172,0,0,0,0,0,0,1,1,4,33,149,1102,3526,10330,15712,20769,23634,25537,26994,28025,28598,28943,29301,29553,29722,29846,29936,30037,30169,30227,30300,30358,30456,30553,30673,30773,31013,31430,31898,32386,32955,33912,35567,38765,42281,46350,50322,53596,0,0,0,0,0,0,0,0,0,0,1,16,86,204,350,452,542,598,618,629,640,668,672,677,690,702,706,708,711,712,718,721,728,732,733,736,756,766,787,813,851,893,979,1130,1411,1829,2388,3105,3840,4473,5351,5881,6324,0,0,0,0,0,0,0,10,79,631,2488,6726,12188,16709,20543,24021,26675,28596,30176,31423,32203,32776,33287,33648,33917,34070,34202,34287,34376,34426,34474,34518,34708,34748,34794,34866,34936,35041,35177,35332,35542,35992,36973,0,0,0,0,0,0,0,0,0,0,4,179,1384,5191,10506,14743,17592,19457,20621,21332,21826,22175,22451,22667,22800,22929,23017,23082,23156,23215,23260,23292,23322,23350,23383,23412,23437,23467,23496,23535,23563,23612,23644,23689,23769,23830,23907,24001,24154,24341,24586,24879,25206,0,0,0,0,0,0,0,0,0,0,0.5,22,107,362.5,701.5,1129.5,1496,1760,1947,2099.5,2198.5,2292.5,2364.5,2421,2500.5,2565.5,2630,2701,2763,2822.5,2882.5,2936.5,3008,3081.5,3208.5,3391,3593,3819.5,4065,4276.5,4478.5,4722.5,4975,5240.5,5529.5,5852,0,0,84,381,520]},"columns":[{"accessor":"country","name":"country","type":"character"},{"accessor":"start_date","name":"start_date","type":"Date"},{"accessor":"end_date","name":"end_date","type":"Date"},{"accessor":"covid_deaths","name":"covid_deaths","type":"numeric"},{"accessor":"excess_deaths","name":"excess_deaths","type":"numeric"},{"accessor":"csum","name":"csum","type":"numeric"}],"defaultPageSize":10,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"eeb24540f9ee5cc1286bfadba1968cd4","key":"eeb24540f9ee5cc1286bfadba1968cd4"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>We need to group each country according to its total deaths related to COVID-19, and excess deaths. Then, using those two numbers, we calculate the percentage of excess deaths attributable to COVID-19. This can be used as a metric for underreporting of COVID-19 cases in a country.</p>
<pre class="r"><code>data_for_table &lt;- data_filtered %&gt;%
  filter(excess_deaths &gt; 0) %&gt;%
  group_by(country) %&gt;%
  summarise(
    excess_deaths = round(sum(excess_deaths)),
    covid_deaths = round(sum(covid_deaths)),
    perc = covid_deaths / excess_deaths
  ) %&gt;%
  select(country, covid_deaths, excess_deaths, perc)

reactable(data_for_table, pagination = FALSE)</code></pre>
<div id="htmlwidget-2" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-2">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"country":["Austria","Belgium","Britain","France","Istanbul","Italy","Jakarta","Netherlands","New York City","Spain","Sweden"],"covid_deaths":[6273,18934,93354,52775,5654,35181,520,11790,24814,53139,8106],"excess_deaths":[9058,20030,99136,56825,9255,65960,4645,18927,28245,74150,9393],"perc":[0.692536983881652,0.945282076884673,0.941676081342802,0.928728552573691,0.610913019989195,0.533368708308065,0.11194833153929,0.622919638611507,0.878527172950965,0.71664194200944,0.862983072500798]},"columns":[{"accessor":"country","name":"country","type":"character"},{"accessor":"covid_deaths","name":"covid_deaths","type":"numeric"},{"accessor":"excess_deaths","name":"excess_deaths","type":"numeric"},{"accessor":"perc","name":"perc","type":"numeric"}],"defaultPageSize":11,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"81b66942872ae326803a1f9782fab0fa","key":"81b66942872ae326803a1f9782fab0fa"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>The only thing missing at this point is the date range. In order to find and display the dates, we need to find the <em>first date after a given country/region hit 50 COVID-19 cases</em> and the <em>last date in the data</em> for that country/region.</p>
<p>How do we do this? First, we’ll create a <a href="https://stackoverflow.com/questions/40039903/r-add-th-rd-and-nd-to-dates">function</a> called <code>append_date_suffix</code> which, according to a given day, appends the appropriate suffix.</p>
<pre class="r"><code>append_date_suffix &lt;- function(dates) {
  suff &lt;- case_when(
    dates %in% c(11, 12, 13) ~ &quot;th&quot;,
    dates %% 10 == 1 ~ &#39;st&#39;,
    dates %% 10 == 2 ~ &#39;nd&#39;,
    dates %% 10 == 3 ~ &#39;rd&#39;,
    TRUE ~ &quot;th&quot;
  )
  paste0(dates, suff)
}</code></pre>
<p>We’ll then group by the <code>country</code> variable and find the min and max date (with the minimum only appearing after a country has seen 50 COVID deaths). Then, we do a lot of formatting of individual days and months, and append them all together with dashes in <em>The Economist’s</em> style. Sorry, there’s a lot going on here.</p>
<pre class="r"><code>dates_data &lt;-
  data_filtered %&gt;%
  # only looking at date ranges starting post-50 deaths
  filter(csum &gt; 50) %&gt;%
  group_by(country) %&gt;%
  summarise(start_date = min(start_date),
            end_date = max(end_date)) %&gt;%
  mutate(
    clean_start_day = format(start_date, &quot;%d&quot;),
    clean_start_day = append_date_suffix(as.numeric(clean_start_day)),
    clean_start_month = format(start_date, &quot;%b&quot;),
    clean_end_day = format(end_date, &quot;%d&quot;),
    clean_end_day = append_date_suffix(as.numeric(clean_end_day)),
    clean_end_month = format(end_date, &quot;%b&quot;)
  ) %&gt;%
  mutate(
    clean_range = paste0(
      clean_start_month,&quot; &quot;, ## Mar
      clean_start_day, &quot;-&quot;, ## 6-
      clean_end_month, &quot; &quot;, ## May
      clean_end_day ## 18
    )
  ) %&gt;%
  select(country, clean_range)</code></pre>
<p>This creates date ranges that look like this:</p>
<div id="htmlwidget-3" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-3">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"country":["Austria","Belgium","Britain","France","Istanbul","Italy","Jakarta","Netherlands","New York City","Spain","Sweden"],"clean_range":["Mar 23rd-Jan 3rd","Mar 16th-Dec 27th","Mar 14th-Jan 8th","Mar 11th-Dec 1st","Mar 25th-Nov 18th","Feb 26th-Oct 27th","Mar 1st-May 31st","Mar 16th-Jan 10th","Mar 15th-Jan 2nd","Mar 4th-Jan 14th","Mar 16th-Dec 27th"]},"columns":[{"accessor":"country","name":"country","type":"character"},{"accessor":"clean_range","name":"clean_range","type":"character"}],"defaultPageSize":11,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"6873b3c55836ebac382f994a57af4ab0","key":"6873b3c55836ebac382f994a57af4ab0"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<p>Join these dates with our existing data…</p>
<pre class="r"><code>data_for_table &lt;- data_filtered %&gt;%
  filter(excess_deaths &gt; 0) %&gt;%
  group_by(country) %&gt;%
  summarise(
    excess_deaths = round(sum(excess_deaths)),
    covid_deaths = round(sum(covid_deaths)),
    perc = covid_deaths / excess_deaths
  ) %&gt;%
  left_join(dates_data, by = &#39;country&#39;) %&gt;%
  select(country, clean_range, covid_deaths, excess_deaths, perc)</code></pre>
<p>and we get our finalized dataset:</p>
<div id="htmlwidget-4" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-4">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"country":["Austria","Belgium","Britain","France","Istanbul","Italy","Jakarta","Netherlands","New York City","Spain","Sweden"],"clean_range":["Mar 23rd-Jan 3rd","Mar 16th-Dec 27th","Mar 14th-Jan 8th","Mar 11th-Dec 1st","Mar 25th-Nov 18th","Feb 26th-Oct 27th","Mar 1st-May 31st","Mar 16th-Jan 10th","Mar 15th-Jan 2nd","Mar 4th-Jan 14th","Mar 16th-Dec 27th"],"covid_deaths":[6273,18934,93354,52775,5654,35181,520,11790,24814,53139,8106],"excess_deaths":[9058,20030,99136,56825,9255,65960,4645,18927,28245,74150,9393],"perc":[0.692536983881652,0.945282076884673,0.941676081342802,0.928728552573691,0.610913019989195,0.533368708308065,0.11194833153929,0.622919638611507,0.878527172950965,0.71664194200944,0.862983072500798]},"columns":[{"accessor":"country","name":"country","type":"character"},{"accessor":"clean_range","name":"clean_range","type":"character"},{"accessor":"covid_deaths","name":"covid_deaths","type":"numeric"},{"accessor":"excess_deaths","name":"excess_deaths","type":"numeric"},{"accessor":"perc","name":"perc","type":"numeric"}],"defaultPageSize":11,"paginationType":"numbers","showPageInfo":true,"minRows":1,"dataKey":"ab0c19bfeb234c2b35e183ee1c9ca924","key":"ab0c19bfeb234c2b35e183ee1c9ca924"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="creating-the-table" class="section level2">
<h2>Creating the table</h2>
<p>Finally, we’re ready to take that dataset and create our table. We can begin by defining some parameters that make the table easier to use and more aesthetically pleasing. Here, we sort according to excess deaths (but don’t include an arrow), make it compact, and show all results on one page.</p>
<pre class="r"><code>reactable(
  data_for_table,
  defaultSortOrder = &#39;desc&#39;,
  defaultSorted = &#39;excess_deaths&#39;,
  showSortIcon = FALSE,
  compact = TRUE,
  pagination = FALSE)</code></pre>
<div id="htmlwidget-5" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-5">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"country":["Austria","Belgium","Britain","France","Istanbul","Italy","Jakarta","Netherlands","New York City","Spain","Sweden"],"clean_range":["Mar 23rd-Jan 3rd","Mar 16th-Dec 27th","Mar 14th-Jan 8th","Mar 11th-Dec 1st","Mar 25th-Nov 18th","Feb 26th-Oct 27th","Mar 1st-May 31st","Mar 16th-Jan 10th","Mar 15th-Jan 2nd","Mar 4th-Jan 14th","Mar 16th-Dec 27th"],"covid_deaths":[6273,18934,93354,52775,5654,35181,520,11790,24814,53139,8106],"excess_deaths":[9058,20030,99136,56825,9255,65960,4645,18927,28245,74150,9393],"perc":[0.692536983881652,0.945282076884673,0.941676081342802,0.928728552573691,0.610913019989195,0.533368708308065,0.11194833153929,0.622919638611507,0.878527172950965,0.71664194200944,0.862983072500798]},"columns":[{"accessor":"country","name":"country","type":"character"},{"accessor":"clean_range","name":"clean_range","type":"character"},{"accessor":"covid_deaths","name":"covid_deaths","type":"numeric"},{"accessor":"excess_deaths","name":"excess_deaths","type":"numeric"},{"accessor":"perc","name":"perc","type":"numeric"}],"defaultSortDesc":true,"defaultSorted":[{"id":"excess_deaths","desc":true}],"defaultPageSize":11,"paginationType":"numbers","showPageInfo":true,"minRows":1,"compact":true,"showSortIcon":false,"dataKey":"ab0c19bfeb234c2b35e183ee1c9ca924","key":"ab0c19bfeb234c2b35e183ee1c9ca924"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
<div id="style-headers" class="section level3">
<h3>Style headers</h3>
<p>Next, let’s make the column headers stylistically similar to <em>The Economist</em>. We do so with reactable’s <code>defaultColDef</code>, where we define a <code>colDef</code> with styles for the header and regular cells. Here, we can include CSS (which you can find by inspecting the table at hand). Throughout this post, you’ll notice my constant references to <code>font_es</code>. This is from <a href="https://github.com/hrbrmstr/hrbrthemes">Bob Rudis’s <code>hrbrthemes</code></a>. It contains the font name for Economist Sans Condensed, which is the font that <em>The Economist</em> uses!</p>
<pre class="r"><code>reactable(
  data_for_table,
  defaultSortOrder = &#39;desc&#39;,
  defaultSorted = &#39;excess_deaths&#39;,
  showSortIcon = FALSE,
  compact = TRUE,
  pagination = FALSE,
  ######## NEW ########
  defaultColDef = colDef(
    ### define header styling
    headerStyle = list(
      textAlign = &quot;left&quot;,
      fontSize = &quot;11px&quot;,
      lineHeight = &quot;14px&quot;,
      textTransform = &quot;uppercase&quot;,
      color = &quot;#0c0c0c&quot;,
      fontWeight = &quot;500&quot;,
      borderBottom = &quot;2px solid #e9edf0&quot;,
      paddingBottom = &quot;3px&quot;,
      verticalAlign = &quot;bottom&quot;,
      fontFamily = font_es
    ),
    ### define default column styling
    style = list(
      fontFamily = font_es,
      fontSize = &quot;14px&quot;,
      verticalAlign = &quot;center&quot;,
      align = &quot;left&quot;
    )
  )
)</code></pre>
<div id="htmlwidget-6" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-6">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"country":["Austria","Belgium","Britain","France","Istanbul","Italy","Jakarta","Netherlands","New York City","Spain","Sweden"],"clean_range":["Mar 23rd-Jan 3rd","Mar 16th-Dec 27th","Mar 14th-Jan 8th","Mar 11th-Dec 1st","Mar 25th-Nov 18th","Feb 26th-Oct 27th","Mar 1st-May 31st","Mar 16th-Jan 10th","Mar 15th-Jan 2nd","Mar 4th-Jan 14th","Mar 16th-Dec 27th"],"covid_deaths":[6273,18934,93354,52775,5654,35181,520,11790,24814,53139,8106],"excess_deaths":[9058,20030,99136,56825,9255,65960,4645,18927,28245,74150,9393],"perc":[0.692536983881652,0.945282076884673,0.941676081342802,0.928728552573691,0.610913019989195,0.533368708308065,0.11194833153929,0.622919638611507,0.878527172950965,0.71664194200944,0.862983072500798]},"columns":[{"accessor":"country","name":"country","type":"character","style":{"fontFamily":"EconSansCndReg","fontSize":"14px","verticalAlign":"center","align":"left"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"clean_range","name":"clean_range","type":"character","style":{"fontFamily":"EconSansCndReg","fontSize":"14px","verticalAlign":"center","align":"left"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"covid_deaths","name":"covid_deaths","type":"numeric","style":{"fontFamily":"EconSansCndReg","fontSize":"14px","verticalAlign":"center","align":"left"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"excess_deaths","name":"excess_deaths","type":"numeric","style":{"fontFamily":"EconSansCndReg","fontSize":"14px","verticalAlign":"center","align":"left"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"perc","name":"perc","type":"numeric","style":{"fontFamily":"EconSansCndReg","fontSize":"14px","verticalAlign":"center","align":"left"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}}],"defaultSortDesc":true,"defaultSorted":[{"id":"excess_deaths","desc":true}],"defaultPageSize":11,"paginationType":"numbers","showPageInfo":true,"minRows":1,"compact":true,"showSortIcon":false,"dataKey":"cf230e9f346904fd937bc812f4f89bea","key":"cf230e9f346904fd937bc812f4f89bea"},"children":[]},"class":"reactR_markup"},"evals":[],"jsHooks":[]}</script>
</div>
<div id="format-columns" class="section level3">
<h3>Format columns</h3>
<p>Now, we can start to format the specific columns appropriately. The three easiest columns are <strong>Region/Country</strong>, <strong>Time Period</strong>, <strong>COVID-19 as % of Total</strong>. In each of these columns, we create a <code>colDef</code> which defines the column name, as well as some styling.</p>
<p>You’ll notice the addition of <code>JS</code> in our percent column. This allows us to include JavaScript in our columns and column headers. I use it to do something simple, like a line break. You can use JS for plenty of more complex purposes, <a href="https://glin.github.io/reactable/articles/examples.html">some of which are documented here</a>.</p>
<pre class="r"><code>reactable(
  data_for_table,
  defaultSortOrder = &#39;desc&#39;,
  defaultSorted = &#39;excess_deaths&#39;,
  showSortIcon = FALSE,
  compact = TRUE,
  pagination = FALSE,
  defaultColDef = colDef(
    headerStyle = list(
      textAlign = &quot;left&quot;,
      fontSize = &quot;11px&quot;,
      lineHeight = &quot;14px&quot;,
      textTransform = &quot;uppercase&quot;,
      color = &quot;#0c0c0c&quot;,
      fontWeight = &quot;500&quot;,
      borderBottom = &quot;2px solid #e9edf0&quot;,
      paddingBottom = &quot;3px&quot;,
      verticalAlign = &quot;bottom&quot;,
      fontFamily = font_es
    ),
    style = list(
      fontFamily = font_es,
      fontSize = &quot;14px&quot;,
      verticalAlign = &quot;center&quot;,
      align = &quot;left&quot;
    )
  ),
  ####### NEW #######
  columns = list(
    country = colDef(
      name = &quot;Region / Country&quot;,
      style = list(fontFamily = font_es,
                   fontWeight = &quot;400&quot;)
    ),
    perc = colDef(
      html = TRUE,
      header = JS(&quot;
      function(colInfo) {
        return &#39;COVID-19 as&lt;br&gt;% of total&#39;
      }&quot;),
      name = &quot;COVID-19 as % of Total&quot;,
      align = &quot;right&quot;,
      maxWidth = 100,
      format = colFormat(percent = TRUE, digits = 0),
      style = list(fontFamily =  font_es_bold),
      headerStyle = list(
        fontSize = &quot;11px&quot;,
        lineHeight = &quot;14px&quot;,
        textTransform = &quot;uppercase&quot;,
        color = &quot;#0c0c0c&quot;,
        fontWeight = &quot;500&quot;,
        borderBottom = &quot;2px solid #e9edf0&quot;,
        paddingBottom = &quot;3px&quot;,
        verticalAlign = &quot;bottom&quot;,
        fontFamily = font_es,
        textAlign = &quot;right&quot;
      )
    ),
    clean_range = colDef(
      name = &quot;Time Period&quot;,
      style = list(
        color = &#39;#3f5661&#39;,
        fontSize = &#39;12px&#39;,
        fontFamily = font_es
      )
    )
  )
)</code></pre>
<div id="htmlwidget-7" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-7">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"country":["Austria","Belgium","Britain","France","Istanbul","Italy","Jakarta","Netherlands","New York City","Spain","Sweden"],"clean_range":["Mar 23rd-Jan 3rd","Mar 16th-Dec 27th","Mar 14th-Jan 8th","Mar 11th-Dec 1st","Mar 25th-Nov 18th","Feb 26th-Oct 27th","Mar 1st-May 31st","Mar 16th-Jan 10th","Mar 15th-Jan 2nd","Mar 4th-Jan 14th","Mar 16th-Dec 27th"],"covid_deaths":[6273,18934,93354,52775,5654,35181,520,11790,24814,53139,8106],"excess_deaths":[9058,20030,99136,56825,9255,65960,4645,18927,28245,74150,9393],"perc":[0.692536983881652,0.945282076884673,0.941676081342802,0.928728552573691,0.610913019989195,0.533368708308065,0.11194833153929,0.622919638611507,0.878527172950965,0.71664194200944,0.862983072500798]},"columns":[{"accessor":"country","name":"Region / Country","type":"character","style":{"fontFamily":"EconSansCndReg","fontWeight":"400"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"clean_range","name":"Time Period","type":"character","style":{"color":"#3f5661","fontSize":"12px","fontFamily":"EconSansCndReg"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"covid_deaths","name":"covid_deaths","type":"numeric","style":{"fontFamily":"EconSansCndReg","fontSize":"14px","verticalAlign":"center","align":"left"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"excess_deaths","name":"excess_deaths","type":"numeric","style":{"fontFamily":"EconSansCndReg","fontSize":"14px","verticalAlign":"center","align":"left"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"perc","name":"COVID-19 as % of Total","type":"numeric","style":{"fontFamily":"EconSansCndBol"},"headerStyle":{"fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg","textAlign":"right"},"format":{"cell":{"digits":0,"percent":true},"aggregated":{"digits":0,"percent":true}},"header":"\n      function(colInfo) {\n        return 'COVID-19 as<br>% of total'\n      }","html":true,"maxWidth":100,"align":"right"}],"defaultSortDesc":true,"defaultSorted":[{"id":"excess_deaths","desc":true}],"defaultPageSize":11,"paginationType":"numbers","showPageInfo":true,"minRows":1,"compact":true,"showSortIcon":false,"dataKey":"a9f27f217d5b771773efca2eb8912d22","key":"a9f27f217d5b771773efca2eb8912d22"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.4.header"],"jsHooks":[]}</script>
</div>
<div id="add-the-barcharts" class="section level3">
<h3>Add the barcharts</h3>
<p>We can now create the ‘deaths’ columns, which include barcharts.</p>
<p><code>reactable</code> makes the addition of barcharts to tables quite easy, thanks to its integration of JavaScript. Here, I pull from one <a href="https://glin.github.io/reactable/articles/twitter-followers/twitter-followers.html">example</a> on <code>reactable</code>’s website, and use the following code:</p>
<pre class="r"><code>reactable(
  data_for_table,
  defaultSortOrder = &#39;desc&#39;,
  defaultSorted = &#39;excess_deaths&#39;,
  showSortIcon = FALSE,
  compact = TRUE,
  pagination = FALSE,
  defaultColDef = colDef(
    headerStyle = list(
      textAlign = &quot;left&quot;,
      fontSize = &quot;11px&quot;,
      lineHeight = &quot;14px&quot;,
      textTransform = &quot;uppercase&quot;,
      color = &quot;#0c0c0c&quot;,
      fontWeight = &quot;500&quot;,
      borderBottom = &quot;2px solid #e9edf0&quot;,
      paddingBottom = &quot;3px&quot;,
      verticalAlign = &quot;bottom&quot;,
      fontFamily = font_es
    ),
    style = list(
      fontFamily = font_es,
      fontSize = &quot;14px&quot;,
      verticalAlign = &quot;center&quot;,
      align = &quot;left&quot;
    )
  ),
  columns = list(
    country = colDef(
      name = &quot;Region / Country&quot;,
      style = list(fontFamily = font_es,
                   fontWeight = &quot;400&quot;)
    ),
    perc = colDef(
      html = TRUE,
      header = JS(&quot;
      function(colInfo) {
        return &#39;COVID-19 as&lt;br&gt;% of total&#39;
      }&quot;),
      name = &quot;COVID-19 as % of Total&quot;,
      align = &quot;right&quot;,
      maxWidth = 100,
      format = colFormat(percent = TRUE, digits = 0),
      style = list(fontFamily =  font_es_bold),
      headerStyle = list(
        fontSize = &quot;11px&quot;,
        lineHeight = &quot;14px&quot;,
        textTransform = &quot;uppercase&quot;,
        color = &quot;#0c0c0c&quot;,
        fontWeight = &quot;500&quot;,
        borderBottom = &quot;2px solid #e9edf0&quot;,
        paddingBottom = &quot;3px&quot;,
        verticalAlign = &quot;bottom&quot;,
        fontFamily = font_es,
        textAlign = &quot;right&quot;
      )
    ),
    clean_range = colDef(
      name = &quot;Time Period&quot;,
      style = list(
        color = &#39;#3f5661&#39;,
        fontSize = &#39;12px&#39;,
        fontFamily = font_es
      )
    ),
    ###### NEW ######
    covid_deaths = colDef(
      name = &quot;COVID-19 Deaths&quot;,
      cell = function(value) {
        width &lt;- paste0(value * 100 / max(data_for_table$covid_deaths), &quot;%&quot;)
        value &lt;- format(value, big.mark = &quot;,&quot;)
        value &lt;- format(value, width = 10, justify = &quot;right&quot;)
        bar &lt;- div(
          class = &quot;bar-chart&quot;,
          style = list(marginRight = &quot;6px&quot;),
          div(
            class = &quot;bar&quot;,
            style = list(width = width, backgroundColor = &quot;#F15A3F&quot;)
          )
        )
        div(class = &quot;bar-cell&quot;, span(class = &quot;number&quot;, value), bar)
      }
    ),
    excess_deaths = colDef(
      name = &quot;Total Excess Deaths&quot;,
      cell = function(value) {
        width &lt;-
          paste0(value * 100 / max(data_for_table$excess_deaths), &quot;%&quot;)
        value &lt;- format(value, big.mark = &quot;,&quot;)
        value &lt;- format(value, width = 10, justify = &quot;right&quot;)
        bar &lt;- div(
          class = &quot;bar-chart&quot;,
          style = list(marginRight = &quot;6px&quot;),
          div(
            class = &quot;bar&quot;,
            style = list(width = width, backgroundColor = &quot;#3F5661&quot;)
          )
        )
        div(class = &quot;bar-cell&quot;, span(class = &quot;number&quot;, value), bar)
      }
    )
  )
)</code></pre>
<p>Let’s break that down step-by-step, with a focus on <code>covid_deaths</code>.</p>
<p>First, we need to define some CSS. <code>reactable</code> allows you to easily include CSS is RMarkdown documents, in chunks defined as <code>css</code>.</p>
<pre class="css"><code>.bar-cell {
  display: flex;
  align-items: center;
}

.number {
  font-size: 13.5px;
  white-space: pre;
}

.bar-chart {
  flex-grow: 1;
  margin-left: 6px;
  height: 22px;
}

.bar {
  height: 100%;
}</code></pre>
<style type="text/css">
.bar-cell {
  display: flex;
  align-items: center;
}

.number {
  font-size: 13.5px;
  white-space: pre;
}

.bar-chart {
  flex-grow: 1;
  margin-left: 6px;
  height: 22px;
}

.bar {
  height: 100%;
}
</style>
<p>Now, let’s look at how we define <code>covid_deaths</code>:</p>
<pre class="r"><code>  covid_deaths = colDef(
    ### define the name
    name = &quot;COVID-19 Deaths&quot;,
    ### create a &#39;cell&#39; function
    cell = function(value) {
      ### define the bar width according to the specified value
      width &lt;- paste0(value * 100 / max(data_for_table$covid_deaths), &quot;%&quot;)
      ### add a comma to the label
      value &lt;- format(value, big.mark = &quot;,&quot;)
      ### justify and provide padding with width
      value &lt;- format(value, width = 10, justify = &quot;right&quot;)
      ### create the barchart div
      bar &lt;- div(
        ### with a class of &#39;bar-chart&#39;
        class = &quot;bar-chart&quot;,
        ### give the bar a margin
        style = list(marginRight = &quot;6px&quot;),
        ### create the *actual* bar, with the red economist color
        div(
          class = &quot;bar&quot;,
          style = list(width = width, backgroundColor = &quot;#F15A3F&quot;)
        )
      )
      ### bring it all together, with the &#39;value&#39; (number) preceding the bar itself
      div(class = &quot;bar-cell&quot;, span(class = &quot;number&quot;, value), bar)
    }
  )</code></pre>
<p>This creates a table that looks like this:</p>
<div id="htmlwidget-8" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-8">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"country":["Austria","Belgium","Britain","France","Istanbul","Italy","Jakarta","Netherlands","New York City","Spain","Sweden"],"clean_range":["Mar 23rd-Jan 3rd","Mar 16th-Dec 27th","Mar 14th-Jan 8th","Mar 11th-Dec 1st","Mar 25th-Nov 18th","Feb 26th-Oct 27th","Mar 1st-May 31st","Mar 16th-Jan 10th","Mar 15th-Jan 2nd","Mar 4th-Jan 14th","Mar 16th-Dec 27th"],"covid_deaths":[6273,18934,93354,52775,5654,35181,520,11790,24814,53139,8106],"excess_deaths":[9058,20030,99136,56825,9255,65960,4645,18927,28245,74150,9393],"perc":[0.692536983881652,0.945282076884673,0.941676081342802,0.928728552573691,0.610913019989195,0.533368708308065,0.11194833153929,0.622919638611507,0.878527172950965,0.71664194200944,0.862983072500798]},"columns":[{"accessor":"country","name":"Region / Country","type":"character","style":{"fontFamily":"EconSansCndReg","fontWeight":"400"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"clean_range","name":"Time Period","type":"character","style":{"color":"#3f5661","fontSize":"12px","fontFamily":"EconSansCndReg"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"covid_deaths","name":"COVID-19 Deaths","type":"numeric","style":{"fontFamily":"EconSansCndReg","fontSize":"14px","verticalAlign":"center","align":"left"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"},"cell":[{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     6,273"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"6.71958352079182%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    18,934"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"20.2819375709664%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    93,354"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"100%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    52,775"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"56.5321250294578%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     5,654"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"6.05651605715877%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    35,181"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"37.6855839064207%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["       520"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"0.557019517106926%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    11,790"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"12.6293463590205%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    24,814"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"26.5805428797909%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    53,139"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"56.9220386914326%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     8,106"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"8.68307731859374%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]}]},{"accessor":"excess_deaths","name":"Total Excess Deaths","type":"numeric","style":{"fontFamily":"EconSansCndReg","fontSize":"14px","verticalAlign":"center","align":"left"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"},"cell":[{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     9,058"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"9.13694318915429%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    20,030"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"20.2045674628793%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    99,136"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"100%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    56,825"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"57.3202469335055%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     9,255"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"9.33566010329245%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    65,960"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"66.5348612007747%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     4,645"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"4.68548256939961%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    18,927"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"19.0919544867657%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    28,245"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"28.4911636539703%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    74,150"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"74.7962395093609%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     9,393"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"9.47486281471917%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]}]},{"accessor":"perc","name":"COVID-19 as % of Total","type":"numeric","style":{"fontFamily":"EconSansCndBol"},"headerStyle":{"fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg","textAlign":"right"},"format":{"cell":{"digits":0,"percent":true},"aggregated":{"digits":0,"percent":true}},"header":"\n      function(colInfo) {\n        return 'COVID-19 as<br>% of total'\n      }","html":true,"maxWidth":100,"align":"right"}],"defaultSortDesc":true,"defaultSorted":[{"id":"excess_deaths","desc":true}],"defaultPageSize":11,"paginationType":"numbers","showPageInfo":true,"minRows":1,"compact":true,"showSortIcon":false,"dataKey":"041148d21e086b68157f578f86be38ff","key":"041148d21e086b68157f578f86be38ff"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.4.header"],"jsHooks":[]}</script>
</div>
<div id="add-a-title" class="section level3">
<h3>Add a title</h3>
<p>Finally, we can add the table title and subtitle. We do so by storing the above table in our environment. (This is the final table code!)</p>
<pre class="r"><code>table &lt;- reactable(
  data_for_table,
  defaultSortOrder = &#39;desc&#39;,
  defaultSorted = &#39;excess_deaths&#39;,
  showSortIcon = FALSE,
  compact = TRUE,
  pagination = FALSE,
  defaultColDef = colDef(
    headerStyle = list(
      textAlign = &quot;left&quot;,
      fontSize = &quot;11px&quot;,
      lineHeight = &quot;14px&quot;,
      textTransform = &quot;uppercase&quot;,
      color = &quot;#0c0c0c&quot;,
      fontWeight = &quot;500&quot;,
      borderBottom = &quot;2px solid #e9edf0&quot;,
      paddingBottom = &quot;3px&quot;,
      verticalAlign = &quot;bottom&quot;,
      fontFamily = font_es
    ),
    style = list(
      fontFamily = font_es,
      fontSize = &quot;14px&quot;,
      verticalAlign = &quot;center&quot;,
      align = &quot;left&quot;
    )
  ),
  
  columns = list(
    country = colDef(
      name = &quot;Region / Country&quot;,
      style = list(fontFamily = font_es,
                   fontWeight = &quot;400&quot;)
    ),
    covid_deaths = colDef(
      name = &quot;COVID-19 Deaths&quot;,
      # align = &quot;left&quot;,
      cell = function(value) {
        width &lt;- paste0(value * 100 / max(data_for_table$covid_deaths), &quot;%&quot;)
        value &lt;- format(value, big.mark = &quot;,&quot;)
        # value &lt;- str_pad(value, 6, pad = &quot;&quot;)
        value &lt;- format(value, width = 10, justify = &quot;right&quot;)
        bar &lt;- div(
          class = &quot;bar-chart&quot;,
          style = list(marginRight = &quot;6px&quot;),
          div(
            class = &quot;bar&quot;,
            style = list(width = width, backgroundColor = &quot;#F15A3F&quot;)
          )
        )
        div(class = &quot;bar-cell&quot;, span(class = &quot;number&quot;, value), bar)
      }
    ),
    excess_deaths = colDef(
      name = &quot;Total Excess Deaths&quot;,
      # align = &quot;left&quot;,
      cell = function(value) {
        width &lt;-
          paste0(value * 100 / max(data_for_table$excess_deaths), &quot;%&quot;)
        value &lt;- format(value, big.mark = &quot;,&quot;)
        value &lt;- format(value, width = 10, justify = &quot;right&quot;)
        bar &lt;- div(
          class = &quot;bar-chart&quot;,
          style = list(marginRight = &quot;6px&quot;),
          div(
            class = &quot;bar&quot;,
            style = list(width = width, backgroundColor = &quot;#3F5661&quot;)
          )
        )
        div(class = &quot;bar-cell&quot;, span(class = &quot;number&quot;, value), bar)
      }
    ),
    perc = colDef(
      html = TRUE,
      header = JS(&quot;
      function(colInfo) {
        return &#39;COVID-19 as&lt;br&gt;% of total&#39;
      }&quot;),
      name = &quot;COVID-19 as % of Total&quot;,
      align = &quot;right&quot;,
      maxWidth = 100,
      format = colFormat(percent = TRUE, digits = 0),
      style = list(fontFamily =  font_es_bold),
      headerStyle = list(
        fontSize = &quot;11px&quot;,
        lineHeight = &quot;14px&quot;,
        textTransform = &quot;uppercase&quot;,
        color = &quot;#0c0c0c&quot;,
        fontWeight = &quot;500&quot;,
        borderBottom = &quot;2px solid #e9edf0&quot;,
        paddingBottom = &quot;3px&quot;,
        verticalAlign = &quot;bottom&quot;,
        fontFamily = font_es,
        textAlign = &quot;right&quot;
      )
    ),
    clean_range = colDef(
      name = &quot;Time Period&quot;,
      style = list(
        color = &#39;#3f5661&#39;,
        fontSize = &#39;12px&#39;,
        fontFamily = font_es
      )
    )
  ),
)</code></pre>
<p>Now, we can include a title and subtitle above the table. We use some <code>htmltools</code> functions to create divs, headers, and paragraphs.</p>
<pre class="r"><code>div(
    div(
      h2(&quot;Excess mortality since region/country’s first 50 covid deaths&quot;),
      p(
        ### create the &#39;Updated on ...&#39; and make it dynamic
        paste0(
          &quot;Updated on &quot;, format(Sys.Date(), &quot;%B &quot;),
          append_date_suffix(as.numeric(format(Sys.Date(), &quot;%d&quot;))), &quot; &quot;,
          strftime(Sys.time(), format = &quot;%H:%M&quot;), &quot; UCT&quot;
        )
      ),
    ),
    table)</code></pre>
<div>
<div>
<h2>Excess mortality since region/country’s first 50 covid deaths</h2>
<p>Updated on January 25th 07:50 UCT</p>
</div>
<div id="htmlwidget-9" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-9">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"country":["Austria","Belgium","Britain","France","Istanbul","Italy","Jakarta","Netherlands","New York City","Spain","Sweden"],"clean_range":["Mar 23rd-Jan 3rd","Mar 16th-Dec 27th","Mar 14th-Jan 8th","Mar 11th-Dec 1st","Mar 25th-Nov 18th","Feb 26th-Oct 27th","Mar 1st-May 31st","Mar 16th-Jan 10th","Mar 15th-Jan 2nd","Mar 4th-Jan 14th","Mar 16th-Dec 27th"],"covid_deaths":[6273,18934,93354,52775,5654,35181,520,11790,24814,53139,8106],"excess_deaths":[9058,20030,99136,56825,9255,65960,4645,18927,28245,74150,9393],"perc":[0.692536983881652,0.945282076884673,0.941676081342802,0.928728552573691,0.610913019989195,0.533368708308065,0.11194833153929,0.622919638611507,0.878527172950965,0.71664194200944,0.862983072500798]},"columns":[{"accessor":"country","name":"Region / Country","type":"character","style":{"fontFamily":"EconSansCndReg","fontWeight":"400"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"clean_range","name":"Time Period","type":"character","style":{"color":"#3f5661","fontSize":"12px","fontFamily":"EconSansCndReg"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"covid_deaths","name":"COVID-19 Deaths","type":"numeric","style":{"fontFamily":"EconSansCndReg","fontSize":"14px","verticalAlign":"center","align":"left"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"},"cell":[{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     6,273"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"6.71958352079182%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    18,934"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"20.2819375709664%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    93,354"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"100%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    52,775"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"56.5321250294578%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     5,654"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"6.05651605715877%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    35,181"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"37.6855839064207%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["       520"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"0.557019517106926%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    11,790"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"12.6293463590205%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    24,814"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"26.5805428797909%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    53,139"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"56.9220386914326%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     8,106"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"8.68307731859374%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]}]},{"accessor":"excess_deaths","name":"Total Excess Deaths","type":"numeric","style":{"fontFamily":"EconSansCndReg","fontSize":"14px","verticalAlign":"center","align":"left"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"},"cell":[{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     9,058"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"9.13694318915429%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    20,030"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"20.2045674628793%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    99,136"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"100%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    56,825"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"57.3202469335055%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     9,255"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"9.33566010329245%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    65,960"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"66.5348612007747%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     4,645"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"4.68548256939961%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    18,927"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"19.0919544867657%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    28,245"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"28.4911636539703%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    74,150"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"74.7962395093609%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     9,393"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"9.47486281471917%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]}]},{"accessor":"perc","name":"COVID-19 as % of Total","type":"numeric","style":{"fontFamily":"EconSansCndBol"},"headerStyle":{"fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg","textAlign":"right"},"format":{"cell":{"digits":0,"percent":true},"aggregated":{"digits":0,"percent":true}},"header":"\n      function(colInfo) {\n        return 'COVID-19 as<br>% of total'\n      }","html":true,"maxWidth":100,"align":"right"}],"defaultSortDesc":true,"defaultSorted":[{"id":"excess_deaths","desc":true}],"defaultPageSize":11,"paginationType":"numbers","showPageInfo":true,"minRows":1,"compact":true,"showSortIcon":false,"dataKey":"041148d21e086b68157f578f86be38ff","key":"041148d21e086b68157f578f86be38ff"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.4.header"],"jsHooks":[]}</script>
</div>
<p>Yikes! Those font sizes don’t quite line up with <em>The Economist</em>’s. Let’s add classes to our divs to match their style.</p>
<pre class="css"><code>.table {
  margin: 0 auto;
  width: 675px;
}

.tableTitle {
  margin: 6px 0;
  font-size: 16px;
  font-family: &#39;Econ Sans Cnd&#39;
}

.tableTitle h2 {
  font-size: 16px;
  font-weight: bold;
  font-family: &#39;Econ Sans Cnd&#39;
}

.tableTitle p {
  font-size: 14px;
  font-weight: 500;
}</code></pre>
<style type="text/css">
.table {
  margin: 0 auto;
  width: 675px;
}

.tableTitle {
  margin: 6px 0;
  font-size: 16px;
  font-family: 'Econ Sans Cnd'
}

.tableTitle h2 {
  font-size: 16px;
  font-weight: bold;
  font-family: 'Econ Sans Cnd'
}

.tableTitle p {
  font-size: 14px;
  font-weight: 500;
}
</style>
<pre class="r"><code>div(class = &quot;tableTitle&quot;,
    div(
      class = &quot;title&quot;,
      h2(&quot;Excess mortality since region/country’s first 50 covid deaths&quot;),
      p(
        paste0(&quot;Updated on &quot;, format(Sys.Date(),&quot;%B &quot;),
          append_date_suffix(as.numeric(format(Sys.Date(), &quot;%d&quot;))), &quot; &quot;,
          strftime(Sys.time(), format = &quot;%H:%M&quot;), &quot; UCT&quot;
        )
      ),
    ),
    table)</code></pre>
<div class="tableTitle">
<div class="title">
<h2>Excess mortality since region/country’s first 50 covid deaths</h2>
<p>Updated on January 25th 07:50 UCT</p>
</div>
<div id="htmlwidget-10" class="reactable html-widget" style="width:auto;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-10">{"x":{"tag":{"name":"Reactable","attribs":{"data":{"country":["Austria","Belgium","Britain","France","Istanbul","Italy","Jakarta","Netherlands","New York City","Spain","Sweden"],"clean_range":["Mar 23rd-Jan 3rd","Mar 16th-Dec 27th","Mar 14th-Jan 8th","Mar 11th-Dec 1st","Mar 25th-Nov 18th","Feb 26th-Oct 27th","Mar 1st-May 31st","Mar 16th-Jan 10th","Mar 15th-Jan 2nd","Mar 4th-Jan 14th","Mar 16th-Dec 27th"],"covid_deaths":[6273,18934,93354,52775,5654,35181,520,11790,24814,53139,8106],"excess_deaths":[9058,20030,99136,56825,9255,65960,4645,18927,28245,74150,9393],"perc":[0.692536983881652,0.945282076884673,0.941676081342802,0.928728552573691,0.610913019989195,0.533368708308065,0.11194833153929,0.622919638611507,0.878527172950965,0.71664194200944,0.862983072500798]},"columns":[{"accessor":"country","name":"Region / Country","type":"character","style":{"fontFamily":"EconSansCndReg","fontWeight":"400"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"clean_range","name":"Time Period","type":"character","style":{"color":"#3f5661","fontSize":"12px","fontFamily":"EconSansCndReg"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"}},{"accessor":"covid_deaths","name":"COVID-19 Deaths","type":"numeric","style":{"fontFamily":"EconSansCndReg","fontSize":"14px","verticalAlign":"center","align":"left"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"},"cell":[{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     6,273"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"6.71958352079182%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    18,934"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"20.2819375709664%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    93,354"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"100%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    52,775"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"56.5321250294578%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     5,654"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"6.05651605715877%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    35,181"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"37.6855839064207%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["       520"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"0.557019517106926%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    11,790"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"12.6293463590205%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    24,814"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"26.5805428797909%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    53,139"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"56.9220386914326%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     8,106"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"8.68307731859374%","backgroundColor":"#F15A3F"},"className":"bar"},"children":[]}]}]}]},{"accessor":"excess_deaths","name":"Total Excess Deaths","type":"numeric","style":{"fontFamily":"EconSansCndReg","fontSize":"14px","verticalAlign":"center","align":"left"},"headerStyle":{"textAlign":"left","fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg"},"cell":[{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     9,058"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"9.13694318915429%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    20,030"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"20.2045674628793%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    99,136"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"100%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    56,825"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"57.3202469335055%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     9,255"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"9.33566010329245%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    65,960"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"66.5348612007747%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     4,645"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"4.68548256939961%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    18,927"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"19.0919544867657%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    28,245"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"28.4911636539703%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["    74,150"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"74.7962395093609%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]},{"name":"div","attribs":{"className":"bar-cell"},"children":[{"name":"span","attribs":{"className":"number"},"children":["     9,393"]},{"name":"div","attribs":{"style":{"marginRight":"6px"},"className":"bar-chart"},"children":[{"name":"div","attribs":{"style":{"width":"9.47486281471917%","backgroundColor":"#3F5661"},"className":"bar"},"children":[]}]}]}]},{"accessor":"perc","name":"COVID-19 as % of Total","type":"numeric","style":{"fontFamily":"EconSansCndBol"},"headerStyle":{"fontSize":"11px","lineHeight":"14px","textTransform":"uppercase","color":"#0c0c0c","fontWeight":"500","borderBottom":"2px solid #e9edf0","paddingBottom":"3px","verticalAlign":"bottom","fontFamily":"EconSansCndReg","textAlign":"right"},"format":{"cell":{"digits":0,"percent":true},"aggregated":{"digits":0,"percent":true}},"header":"\n      function(colInfo) {\n        return 'COVID-19 as<br>% of total'\n      }","html":true,"maxWidth":100,"align":"right"}],"defaultSortDesc":true,"defaultSorted":[{"id":"excess_deaths","desc":true}],"defaultPageSize":11,"paginationType":"numbers","showPageInfo":true,"minRows":1,"compact":true,"showSortIcon":false,"dataKey":"041148d21e086b68157f578f86be38ff","key":"041148d21e086b68157f578f86be38ff"},"children":[]},"class":"reactR_markup"},"evals":["tag.attribs.columns.4.header"],"jsHooks":[]}</script>
</div>
<p>Let’s compare that to the table we’re attempting to replicate. Note that some of the data has changed in the time between <em>The Economist</em> published their table and I created mine.</p>
<div style="text-align: center">
<p><img width = 100% src = img/econ-table.png></p>
</div>
</div>
</div>
